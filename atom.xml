<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  
  <title><![CDATA[èµµå…ƒæ°çš„æŠ€æœ¯åšå®¢]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://qq157755587.github.io//"/>
  <updated>2016-08-13T09:02:56.000Z</updated>
  <id>http://qq157755587.github.io//</id>
  
  <author>
    <name><![CDATA[èµµå…ƒæ°]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[Chrome Custom Tabsæœ€ä½³å®è·µ]]></title>
    <link href="http://qq157755587.github.io/2016/08/12/custom-tabs-best-practices/"/>
    <id>http://qq157755587.github.io/2016/08/12/custom-tabs-best-practices/</id>
    <published>2016-08-12T08:54:34.000Z</published>
    <updated>2016-08-13T09:02:56.000Z</updated>
    <content type="html"><![CDATA[<p>è·ç¦»Googleå‘å¸ƒChrome Custom Tabså·²ç»ä¸€å¹´ï¼ŒTwitterã€Mediumç­‰å›½å¤–Appæ—©å·²æ”¯æŒäº†è¿™ä¸ªåŠŸèƒ½ï¼Œä½†é—æ†¾çš„æ˜¯å›½å†…Appé²œæœ‰æ”¯æŒã€‚è¿™ç¯‡æ–‡ç« ä»¥å®˜æ–¹<a href="https://developer.chrome.com/multidevice/android/customtabs" target="_blank" rel="external">å¼€å‘æ–‡æ¡£</a>å’Œ<a href="https://github.com/GoogleChrome/custom-tabs-client" target="_blank" rel="external">ç¤ºä¾‹æºç </a>ä¸ºåŸºç¡€ï¼ŒåŠ ä¸Šè‡ªå·±çš„ç†è§£ï¼Œå¸Œæœ›èƒ½å¸®åŠ©è¯»è€…å¿«é€ŸæŒæ¡Chrome Custom Tabsçš„ç”¨æ³•ã€‚</p>
<h1 id="ä¸ºä»€ä¹ˆè¦ç”¨Chrome_Custom_Tabsï¼Ÿ">ä¸ºä»€ä¹ˆè¦ç”¨Chrome Custom Tabsï¼Ÿ</h1><p>å½“Appéœ€è¦æ‰“å¼€ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œå¼€å‘è€…é¢ä¸´ä¸¤ç§é€‰æ‹©ï¼šé»˜è®¤æµè§ˆå™¨æˆ–WebViewã€‚è¿™ä¸¤ç§é€‰æ‹©éƒ½æœ‰ä¸è¶³ã€‚ä»Appè·³è½¬åˆ°æµè§ˆå™¨æ˜¯ä¸€ä¸ªéå¸¸é‡çš„åˆ‡æ¢ï¼Œå¹¶ä¸”æµè§ˆå™¨æ— æ³•è‡ªå®šä¹‰ï¼›è€ŒWebViewæ— æ³•ä¸æµè§ˆå™¨å…±äº«cookiesç­‰æ•°æ®ï¼Œå¹¶ä¸”éœ€è¦å¼€å‘è€…å¤„ç†éå¸¸å¤šçš„åœºæ™¯ã€‚</p>
<p>Chrome Custom Tabsæä¾›äº†ä¸€ç§æ–°çš„é€‰æ‹©ï¼Œæ—¢èƒ½åœ¨Appå’Œç½‘é¡µä¹‹é—´æµç•…åˆ‡æ¢ï¼Œåˆèƒ½æœ‰å¤šç§è‡ªå®šä¹‰é€‰é¡¹ã€‚å…¶å®å®ƒæœ¬è´¨ä¸Šæ˜¯è°ƒç”¨äº†Chromeä¸­çš„ä¸€ä¸ªActivityæ¥æ‰“å¼€ç½‘é¡µï¼Œè¿™æ ·æƒ³å°±èƒ½ç†è§£è¿™äº›ä¼˜ç‚¹äº†ã€‚èƒ½è‡ªå®šä¹‰çš„é¡¹ç›®æœ‰ï¼š</p>
<ul>
<li><p>Toolbaré¢œè‰²</p>
</li>
<li><p>è¿›åœºå’Œå‡ºåœºåŠ¨ç”»</p>
</li>
<li><p>Toolbarä¸Šçš„action buttonï¼Œmenu itemå’Œbottom toolbarï¼ˆé€šè¿‡RemoveViewå®ç°ï¼‰</p>
</li>
</ul>
<p>Chrome Custom Tabsè¿˜æä¾›é¢„å¯åŠ¨Chromeå’Œé¢„åŠ è½½ç½‘é¡µå†…å®¹çš„åŠŸèƒ½ï¼Œä¸ä¼ ç»Ÿæ–¹å¼ç›¸æ¯”åŠ è½½é€Ÿåº¦æœ‰æ˜¾è‘—æå‡ã€‚</p>
<p><img src="https://developer.chrome.com/multidevice/images/customtab/performance.gif" alt="alt"></p>
<h1 id="ä»€ä¹ˆæ—¶å€™ç”¨Chrome_Custom_Tabsï¼Œä»€ä¹ˆæ—¶å€™ç”¨WebViewï¼Ÿ">ä»€ä¹ˆæ—¶å€™ç”¨Chrome Custom Tabsï¼Œä»€ä¹ˆæ—¶å€™ç”¨WebViewï¼Ÿ</h1><p>å¦‚æœWebé¡µé¢æ˜¯ä½ è‡ªå·±çš„å†…å®¹ï¼ˆæ¯”å¦‚æ·˜å®å•†å“é¡µä¹‹äºæ‰‹æœºæ·˜å®ï¼‰ï¼Œé‚£ä¹ˆWebViewæ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºä½ å¯èƒ½éœ€è¦é’ˆå¯¹ç½‘é¡µå†…å®¹åŠç”¨æˆ·æ“ä½œåšéå¸¸å¤šçš„è‡ªå®šä¹‰ã€‚å¦‚æœæ˜¯è·³åˆ°ä¸€ä¸ªå¤–éƒ¨ç½‘ç«™ï¼Œæ¯”å¦‚åœ¨Appä¸­ç‚¹äº†ä¸€ä¸ªå¹¿å‘Šé“¾æ¥è·³è½¬åˆ°å¹¿å‘Šå•†çš„ç½‘ç«™ï¼Œé‚£ä¹ˆå»ºè®®ä½¿ç”¨Chrome Custom Tabsã€‚</p>
<h1 id="å‰ç½®æ¡ä»¶">å‰ç½®æ¡ä»¶</h1><p>ç”¨æˆ·çš„æ‰‹æœºä¸Šéœ€è¦å®‰è£…Chrome <strong>45</strong>æˆ–ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¹¶ä¸”<strong>è®¾ä¸ºé»˜è®¤æµè§ˆå™¨</strong>ã€‚è€ƒè™‘åˆ°Chromeåœ¨å›½å†…æ‰‹æœºä¸Šçš„å æœ‰ç‡ï¼Œè¿™ç¡®å®æ˜¯ä¸ªé—®é¢˜â€¦â€¦ä½†å¦‚æœä½ çš„APPä¸åªæ˜¯é¢å¯¹å›½å†…å¸‚åœºï¼Œé‚£ä¹ˆä»¥Googleåœ¨æµ·å¤–å¸‚åœºçš„å½±å“åŠ›ï¼Œè¿™å®Œå…¨ä¸æ˜¯é—®é¢˜ã€‚</p>
<p>è‚¯å®šæœ‰äººè¦é—®ï¼Œå¦‚æœæ‰‹æœºä¸Šæ²¡æœ‰è£…Chromeï¼Œè°ƒç”¨Chrome Custom Tabsä¼šå‘ç”Ÿä»€ä¹ˆè¡Œä¸ºå‘¢ï¼Ÿæˆ‘ä»¬æŸ¥çœ‹<code>CustomTabsIntent.Builder</code>çš„<a href="https://android.googlesource.com/platform/frameworks/support/+/c502e63/customtabs/src/android/support/customtabs/CustomTabsIntent.java#164" target="_blank" rel="external">æºç </a>å¯ä»¥å‘ç°ï¼ŒBuilderçš„å†…éƒ¨æ„é€ äº†ä¸€ä¸ªactionä¸º<code>Intent.ACTION_VIEW</code>çš„Intentï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯è°ƒç”¨é»˜è®¤æµè§ˆå™¨æ¥æ‰“å¼€URLã€‚</p>
<p>è¿™æ—¶æˆ‘ä»¬å¯ä»¥å‘ç°Chrome Custom Tabsçš„åŸç†ï¼šå¦‚æœChromeæ˜¯é»˜è®¤æµè§ˆå™¨ï¼Œé‚£ä¹ˆè¿™ä¸ªIntentè‡ªç„¶å°±ä¼šå”¤èµ·Chromeï¼Œç„¶åChromeä¼šæ ¹æ®Intentçš„å„ä¸ªExtraæ¥é…ç½®å‰é¢æ‰€è®²çš„è‡ªå®šä¹‰é¡¹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªéšè—çš„å¥½å¤„ï¼š<strong>å¦‚æœä½ çš„å·¥ä½œæ°å¥½æ˜¯å¼€å‘æµè§ˆå™¨ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥æ ¹æ®è¿™äº›Extraä¿¡æ¯æ¥å®šåˆ¶ç•Œé¢ï¼</strong></p>
<h1 id="å¼€å‘å‘å¯¼">å¼€å‘å‘å¯¼</h1><h2 id="å¿«é€Ÿä¸Šæ‰‹">å¿«é€Ÿä¸Šæ‰‹</h2><p>é¦–å…ˆåœ¨ä½ çš„<em>build.gradle</em>æ–‡ä»¶ä¸­åŠ å…¥dependency</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    ...</span><br><span class="line">    compile <span class="string">'com.android.support:customtabs:24.1.1'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå†™å‡ è¡Œä»£ç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String url = <span class="string">"https://www.google.com"</span>;</span><br><span class="line">CustomTabsIntent.Builder builder = <span class="keyword">new</span> CustomTabsIntent.Builder();</span><br><span class="line">CustomTabsIntent customTabsIntent = builder.build();</span><br><span class="line">customTabsIntent.launchUrl(<span class="keyword">this</span>, Uri.parse(url));</span><br></pre></td></tr></table></figure>
<p>å°±å¥½äº†ï¼ä¸è´¹å¹ç°ä¹‹åŠ›~</p>
<p>æ³¨æ„launchUrlè¿™ä¸ªæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸ªActivityã€‚è‚¯å®šæœ‰äººä¼šè·³èµ·æ¥è¯´ï¼Œæˆ‘è¦åœ¨ViewHolderé‡Œé¢å¤„ç†ç‚¹å‡»è·³è½¬ï¼Œæ ¹æœ¬æ‹¿ä¸åˆ°Activityï¼Œåªæœ‰Contextè‚¿ä¹ˆåŠï¼Ÿï¼ï¼ï¼ˆå…¶å®è¿™ä¸ªäººå°±æ˜¯æˆ‘ï¼‰</p>
<p>é‚£ä¹ˆæˆ‘ä»¬çœ‹çœ‹launchUrlçš„æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">launchUrl</span><span class="params">(Activity context, Uri url)</span> </span>&#123;</span><br><span class="line">    intent.setData(url);</span><br><span class="line">    ActivityCompat.startActivity(context, intent, startAnimationBundle);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åŸæ¥æ˜¯ä¸ºäº†ä¼ å…¥startAnimationBundleè¿™ä¸ªå‚æ•°æ¥å®ç°è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»ã€‚é‚£ä¹ˆæˆ‘ä»¬è‡ªå·±å¤„ç†ä¸€ä¸‹å°±å¥½äº†ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (context <span class="keyword">instanceof</span> Activity) &#123;</span><br><span class="line">    customTabsIntent.launchUrl((Activity) context, uri);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    Intent intent = customTabsIntent.intent;</span><br><span class="line">    intent.setData(uri);</span><br><span class="line">    <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN) &#123;</span><br><span class="line">        context.startActivity(intent, customTabsIntent.startAnimationBundle);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        context.startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¿®æ”¹Toolbaré¢œè‰²">ä¿®æ”¹Toolbaré¢œè‰²</h2><p>ä½ ä¸€å®šå¸Œæœ›Chrome Custom Tabsçš„Toolbaré¢œè‰²ä¸ä½ è‡ªå·±APPçš„Toolbaré¢œè‰²ä¿æŒç›¸åŒï¼Œçœ‹èµ·æ¥å°±åƒæ˜¯åœ¨APPå†…æ‰“å¼€ç½‘é¡µä¸€æ ·ã€‚ä¸€è¡Œä»£ç æå®šï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.setToolbarColor(colorInt);</span><br></pre></td></tr></table></figure>
<h2 id="æ·»åŠ action_button">æ·»åŠ action button</h2><p>ä½ å¯èƒ½æƒ³è¦åœ¨Toolbarä¸ŠåŠ ä¸Šaction buttonï¼Œé‚£ä¹ˆéœ€è¦åˆ›å»ºä¸€ä¸ªPendingIntentã€‚ä¸‹é¢çš„ä»£ç å¢åŠ äº†ä¸€ä¸ªå‘é€é‚®ä»¶çš„action buttonï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Intent actionIntent = <span class="keyword">new</span> Intent(Intent.ACTION_SEND);</span><br><span class="line">actionIntent.setType(<span class="string">"*/*"</span>);</span><br><span class="line">actionIntent.putExtra(Intent.EXTRA_EMAIL, <span class="string">"example@example.com"</span>);</span><br><span class="line">actionIntent.putExtra(Intent.EXTRA_SUBJECT, <span class="string">"example"</span>);</span><br><span class="line">PendingIntent pi = PendingIntent.getActivity(<span class="keyword">this</span>, <span class="number">0</span>, actionIntent, <span class="number">0</span>);</span><br><span class="line">Bitmap icon = BitmapFactory.decodeResource(getResources(), R.drawable.ic_share);<span class="comment">//æ³¨æ„åœ¨æ­£å¼é¡¹ç›®ä¸­ä¸è¦åœ¨UIçº¿ç¨‹è¯»å–å›¾ç‰‡</span></span><br><span class="line">builder.setActionButton(icon, <span class="string">"send email"</span>, pi, <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>
<h2 id="æ·»åŠ menu_item">æ·»åŠ menu item</h2><p>Chrome Custom Tabsçš„menué»˜è®¤åŒ…å«äº†ä¸‰ä¸ªæ˜¾ç¤ºä¸ºå›¾æ ‡çš„item(Forward, Page Info, Refresh)å’Œä¸¤ä¸ªæ–‡å­—item(Find in page, Open in Browser)ã€‚æˆ‘ä»¬å¯ä»¥å†æ·»åŠ æœ€å¤š5ä¸ªæ–‡å­—itemã€‚åŒæ ·éœ€è¦åˆ›å»ºPendingIntentï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Intent menuIntent = <span class="keyword">new</span> Intent();</span><br><span class="line">menuIntent.setClass(getApplicationContext(), SomeActivity.class);</span><br><span class="line">PendingIntent pi = PendingIntent.getActivity(getApplicationContext(), <span class="number">0</span>, menuIntent, <span class="number">0</span>);</span><br><span class="line">builder.addMenuItem(<span class="string">"Menu entry 1"</span>, pi);</span><br></pre></td></tr></table></figure>
<h2 id="è®¾ç½®è½¬åœºåŠ¨ç”»">è®¾ç½®è½¬åœºåŠ¨ç”»</h2><p>å¦‚æœä½ çš„APPè®¾ç½®äº†è½¬åœºåŠ¨ç”»ï¼Œé‚£ä¹ˆä¸ºäº†ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒï¼Œå¯ä»¥åœ¨Chrome Custom Tabsä¸­è®¾ç½®åŒæ ·çš„åŠ¨ç”»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">builder.setStartAnimations(<span class="keyword">this</span>, R.anim.slide_in_right, R.anim.slide_out_left);</span><br><span class="line">builder.setExitAnimations(<span class="keyword">this</span>, R.anim.slide_in_left, R.anim.slide_out_right);</span><br></pre></td></tr></table></figure>
<h2 id="é¢„å¯åŠ¨(Warm_up)_Chromeå’Œé¢„åŠ è½½">é¢„å¯åŠ¨(Warm up) Chromeå’Œé¢„åŠ è½½</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè°ƒç”¨äº†<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.html#launchUrl" target="_blank" rel="external">CustomTabsIntent#launchUrl</a>æ–¹æ³•ä¹‹åï¼Œæ‰ä¼šåœ¨åå°å¯åŠ¨ï¼ˆåŸæ–‡æ˜¯spin upï¼‰Chromeï¼Œç„¶ååŠ è½½ç½‘é¡µã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šèŠ±è´¹å®è´µçš„æ—¶é—´ï¼Œå¹¶å½±å“åˆ°ç”¨æˆ·ä½“éªŒã€‚è¦æ˜¯èƒ½ã€Œç§’å¼€ã€ç½‘é¡µé‚£å°±çˆ½äº†ã€‚Chrome Custom Tabså¯ä»¥ç»‘å®šChromeçš„ä¸€ä¸ªServiceï¼Œç»‘å®šæˆåŠŸä¹‹åå¯ä»¥é¢„å¯åŠ¨Chromeï¼Œè¿˜å¯ä»¥è®©Chromeé¢„åŠ è½½ä¸€äº›ç½‘é¡µï¼ˆå½“ç„¶è¿™æ˜¯è¦æ¶ˆè€—ä¸€äº›æµé‡çš„ï¼‰ã€‚å¤§è‡´çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>é€šè¿‡<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#bindCustomTabsService" target="_blank" rel="external">CustomTabsClient#bindCustomTabsService</a>æ–¹æ³•ç»‘å®šServiceã€‚ç»‘å®šæˆåŠŸåä¼šå¾—åˆ°ä¸€ä¸ªCustomTabsClientçš„instanceã€‚å¦‚æœç»‘å®šå¤±è´¥ï¼Œè¯´æ˜Chromeç‰ˆæœ¬è¿‡ä½æˆ–è€…æ²¡æœ‰å®‰è£…ã€‚</li>
<li>é€šè¿‡<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#warmup" target="_blank" rel="external">CustomTabsClient#warmup</a>æ–¹æ³•åœ¨åå°å¯åŠ¨Chromeã€‚</li>
<li>é€šè¿‡<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#newSession" target="_blank" rel="external">CustomTabsClient#newSession</a>æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„sessionã€‚è¿™ä¸€æ­¥è¿˜å¯ä»¥ä¼ å…¥ä¸€ä¸ª<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsCallback.html" target="_blank" rel="external">CustomTabsCallback</a>å‚æ•°ç”¨æ¥å¾—åˆ°sessionçš„çŠ¶æ€ï¼Œæ¯”å¦‚é¡µé¢æ˜¯å¦åŠ è½½å®Œæˆã€‚</li>
<li>é€šè¿‡<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html#mayLaunchUrl" target="_blank" rel="external">CustomTabsSession#mayLaunchUrl</a>æ¥å‘Šè¯‰Chromeè¦é¢„åŠ è½½å“ªäº›ç½‘é¡µã€‚</li>
<li>å½“ç”¨æˆ·ç‚¹å‡»äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå°†å‰é¢é‚£ä¸ªsessionä¼ å…¥<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.Builder.html" target="_blank" rel="external">CustomTabsIntent.Builder</a>ï¼Œç„¶åç”¨æ–‡ç« æœ€å¼€å¤´çš„æ–¹æ³•æ‰“å¼€ç½‘é¡µã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯å®Œæˆè¿™ä¸ªè¿‡ç¨‹çš„ç®€å•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> <span class="keyword">implements</span> <span class="title">ServiceConnectionCallback</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> CustomTabsSession mSession;</span><br><span class="line">    <span class="keyword">private</span> CustomTabsClient mClient;</span><br><span class="line">    <span class="keyword">private</span> CustomTabsServiceConnection mConnection;</span><br><span class="line">  </span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">bindCustomTabsService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mConnection = <span class="keyword">new</span> ServiceConnection(<span class="keyword">this</span>);</span><br><span class="line">        CustomTabsClient.bindCustomTabsService(<span class="keyword">this</span>, <span class="string">"com.android.chrome"</span>, mConnection);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">warmup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mClient != <span class="keyword">null</span>) mClient.warmup(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">preLaunch</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mClent != <span class="keyword">null</span> &amp;&amp; mSession == <span class="keyword">null</span>) &#123;</span><br><span class="line">            mSession = mClient.newSession(<span class="keyword">new</span> CustomTabsCallback(&#123;</span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNavigationEvent</span><span class="params">(<span class="keyword">int</span> navigationEvent, Bundle extras)</span> </span>&#123;</span><br><span class="line">                    <span class="comment">// è¿™é‡Œå¯ä»¥å–åˆ°Sessionçš„çŠ¶æ€</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;));</span><br><span class="line">        &#125;</span><br><span class="line">        mSession.mayLaunchUrl(Uri.parse(url), <span class="keyword">null</span>, <span class="keyword">null</span>);<span class="comment">//è¿™é‡Œçš„ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ä¸€äº›ä½ä¼˜å…ˆçº§çš„Urlï¼Œä½†ä¸èƒ½ä¿è¯ä¼šè¢«é¢„åŠ è½½</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">launch</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">        CustomTabsIntent.Builder builder = <span class="keyword">new</span> CustomTabsIntent.Builder(mSession);</span><br><span class="line">        CustomTabsIntent customTabsIntent = builder.build();</span><br><span class="line">        customTabsIntent.launchUrl(<span class="keyword">this</span>, Uri.parse(url));</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mConnection != <span class="keyword">null</span>) &#123;</span><br><span class="line">            unbindService(mConnection);</span><br><span class="line">            mClient = <span class="keyword">null</span>;</span><br><span class="line">            mSession = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/** ServiceConnectionCallbackçš„å›è°ƒæ–¹æ³• */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServiceConnected</span><span class="params">(CustomTabsClient client)</span> </span>&#123;</span><br><span class="line">        mClient = client;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServiceDisconnected</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mClient = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç®€å•çš„é¢„å¯åŠ¨">ç®€å•çš„é¢„å¯åŠ¨</h2><p>Android Support Library 24.0.0å¼€å§‹åŠ å…¥äº†<a href="https://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#connectAndInitialize" target="_blank" rel="external">CustomTabsClient#connectAndInitialize</a>æ–¹æ³•æ¥ç®€åŒ–é¢„å¯åŠ¨ä»£ç ã€‚å¦‚æœä½ æ— æ³•é¢„æ–™åˆ°ç”¨æˆ·ä¼šæ‰“å¼€å“ªä¸ªURLï¼Œæˆ–è€…å‡ºäºçœç”µçš„è€ƒè™‘ä¸æƒ³é¢„åŠ è½½URLï¼Œé‚£ä¹ˆå¯ä»¥åœ¨Activityçš„onStartä¸­åŠ å…¥ä¸€è¡Œä»£ç æ¥é¢„å¯åŠ¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CustomTabsClient.connectAndInitialize(<span class="keyword">this</span>, <span class="string">"com.android.chrome"</span>);</span><br></pre></td></tr></table></figure>
<h1 id="æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</h1><h2 id="ç»‘å®šCustom_Tabsçš„serviceå¹¶é¢„å¯åŠ¨">ç»‘å®šCustom Tabsçš„serviceå¹¶é¢„å¯åŠ¨</h2><p>é¢„å¯åŠ¨Chromeå¯ä»¥å¸®åŠ©ä½ èŠ‚çœé«˜è¾¾<strong>700ms</strong>çš„å®è´µæ—¶é—´ï¼è¿™å‡ ä¹æ˜¯å¯ä»¥åˆ’åˆ†å¡ä¸ä¸å¡çš„å·®åˆ«ã€‚å¯åŠ¨è¿‡ç¨‹æ˜¯åœ¨åå°ä»¥ä½ä¼˜å…ˆçº§è¿›è¡Œï¼Œæ‰€ä»¥<strong>ä¸ä¼šå¯¹ä½ çš„APPæ€§èƒ½æœ‰è´Ÿé¢å½±å“</strong>ã€‚</p>
<h2 id="é¢„åŠ è½½ç½‘é¡µå†…å®¹">é¢„åŠ è½½ç½‘é¡µå†…å®¹</h2><p>é¢„åŠ è½½ç½‘é¡µåå¯ä»¥è¾¾åˆ°ç§’å¼€çš„æ•ˆæœï¼æ‰€ä»¥å¦‚æœä½ è‡³å°‘æœ‰50%çš„æŠŠæ¡ç”¨æˆ·ä¼šæ‰“å¼€æŸä¸ªURLï¼Œä½ åº”å½“è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html#mayLaunchUrl%28android.net.Uri,%20android.os.Bundle,%20java.util.List%3Candroid.os.Bundle%3E%29" target="_blank" rel="external">mayLaunchUrl()</a>æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šæå‰ä¸‹è½½å¹¶æ¸²æŸ“ç½‘é¡µå†…å®¹ï¼Œä½†ä¸å¯é¿å…çš„ä¼šæœ‰ä¸€ç‚¹æµé‡å’Œç”µé‡çš„æ¶ˆè€—ã€‚å¦‚æœç”¨æˆ·æ­£åœ¨ä½¿ç”¨æ”¶è´¹çš„æ•°æ®æµé‡ï¼Œæˆ–è€…æ‰‹æœºç”µé‡ä¸è¶³ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•ä¸ä¼šç”Ÿæ•ˆã€‚æ‰€ä»¥æˆ‘ä»¬<strong>å®Œå…¨ä¸ç”¨è‡ªå·±è€ƒè™‘æ€§èƒ½ä¼˜åŒ–</strong>ã€‚</p>
<h2 id="å¤‡é€‰æ–¹æ¡ˆ">å¤‡é€‰æ–¹æ¡ˆ</h2><p>å¦‚æœç”¨æˆ·çš„æ‰‹æœºä¸Šæ²¡æœ‰å®‰è£…Chromeï¼Œé‚£ä¹ˆæ‰“å¼€é»˜è®¤æµè§ˆå™¨å¯èƒ½å¹¶ä¸æ˜¯æœ€å¥½çš„ç”¨æˆ·ä½“éªŒã€‚æ‰€ä»¥å¦‚æœåœ¨bindServiceé‚£ä¸€æ­¥å¤±è´¥äº†ï¼Œæ— è®ºæ˜¯æ‰“å¼€é»˜è®¤æµè§ˆå™¨è¿˜æ˜¯WebViewï¼Œé€‰æ‹©ä¸€ä¸ªä½ è®¤ä¸ºæœ€å¥½çš„å¤‡é€‰æ–¹æ¡ˆã€‚</p>
<h2 id="referrer">referrer</h2><p>å¾ˆå¤šç½‘ç«™éƒ½ä¼šç»Ÿè®¡è‡ªå·±çš„æµé‡æ˜¯ä»å“ªå„¿æ¥çš„ï¼Œæ‰€ä»¥æœ€å¥½å‘Šè¯‰ä»–ä»¬æ˜¯ä½ çš„å¸…æ°”APPç»™ä»–ä»¬å¸¦æ¥äº†æµé‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">intent.putExtra(Intent.EXTRA_REFERRER, </span><br><span class="line">        Uri.parse(Intent.URI_ANDROID_APP_SCHEME + <span class="string">"//"</span> + context.getPackageName()));</span><br></pre></td></tr></table></figure>
<h2 id="åŠ å…¥è‡ªå®šä¹‰åŠ¨ç”»">åŠ å…¥è‡ªå®šä¹‰åŠ¨ç”»</h2><p>è‡ªå®šä¹‰çš„è½¬åœºåŠ¨ç”»ä¼šè®©ä½ çš„ç½‘é¡µè·³è½¬æ›´æµç•…ã€‚ç¡®ä¿è¿›åœºåŠ¨ç”»å’Œå‡ºåœºåŠ¨ç”»æ˜¯åå‘çš„ï¼Œæ¯”å¦‚ç½‘é¡µä»å³è¾¹è¿›æ¥ï¼Œå°±ä»å³è¾¹å‡ºå»ï¼Œè¿™æ ·èƒ½å¸®åŠ©ç”¨æˆ·ç†è§£è·³è½¬å…³ç³»ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">builder.setStartAnimations(<span class="keyword">this</span>, R.anim.slide_in_right, R.anim.slide_out_left);</span><br><span class="line">builder.setExitAnimations(<span class="keyword">this</span>, R.anim.slide_in_left, R.anim.slide_out_right);</span><br></pre></td></tr></table></figure>
<h2 id="ä¸ºAction_Buttoné€‰ä¸ªåˆé€‚çš„å›¾æ ‡">ä¸ºAction Buttoné€‰ä¸ªåˆé€‚çš„å›¾æ ‡</h2><p>ä¸€ä¸ªåˆé€‚çš„å›¾æ ‡èƒ½è®©ç”¨æˆ·å¿«é€Ÿçš„ç†è§£åˆ°APPçš„åŠŸèƒ½ã€‚ä½†è®°ä½å›¾æ ‡çš„æœ€å¤§å°ºå¯¸æ˜¯å®½48dpé«˜24dpã€‚</p>
<h2 id="å…¶ä»–æ”¯æŒçš„æµè§ˆå™¨">å…¶ä»–æ”¯æŒçš„æµè§ˆå™¨</h2><p>å‰é¢æœ‰è®²åˆ°å…¶ä»–æµè§ˆå™¨ä¹Ÿæœ‰æœºä¼šæ”¯æŒCustom Tabsçš„åŠŸèƒ½ï¼ˆè™½ç„¶æˆ‘è¿˜æ²¡å‘ç°æœ‰å“ªæ¬¾å·²ç»æ”¯æŒäº†ï¼‰ã€‚å¦‚æœä½ æ£€æµ‹åˆ°ä¸æ­¢ä¸€ä¸ªæµè§ˆå™¨æ”¯æŒCustom Tabsï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æœ€å¥½è¯¢é—®ç”¨æˆ·æ‰“ç®—ç”¨å“ªä¸ªæµè§ˆå™¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * Returns a list of packages that support Custom Tabs.</span><br><span class="line"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ArrayList <span class="title">getCustomTabsPackages</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    PackageManager pm = context.getPackageManager();</span><br><span class="line">    <span class="comment">// Get default VIEW intent handler.</span></span><br><span class="line">    Intent activityIntent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW, Uri.parse(<span class="string">"http://www.example.com"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get all apps that can handle VIEW intents.</span></span><br><span class="line">    List resolvedActivityList = pm.queryIntentActivities(activityIntent, <span class="number">0</span>);</span><br><span class="line">    ArrayList packagesSupportingCustomTabs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (ResolveInfo info : resolvedActivityList) &#123;</span><br><span class="line">        Intent serviceIntent = <span class="keyword">new</span> Intent();</span><br><span class="line">        serviceIntent.setAction(ACTION_CUSTOM_TABS_CONNECTION);</span><br><span class="line">        serviceIntent.setPackage(info.activityInfo.packageName);</span><br><span class="line">        <span class="comment">// Check if this package also resolves the Custom Tabs service.</span></span><br><span class="line">        <span class="keyword">if</span> (pm.resolveService(serviceIntent, <span class="number">0</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            packagesSupportingCustomTabs.add(info);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> packagesSupportingCustomTabs;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç»™ç”¨æˆ·é€‰æ‹©æƒ">ç»™ç”¨æˆ·é€‰æ‹©æƒ</h2><p>å¦‚æœä½ çš„APPä¹‹å‰ä¸€ç›´æ˜¯ç”¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€URLï¼Œåæ¥æ‰åŠ å…¥çš„Custom Tabsï¼Œé‚£ä¹ˆè€ç”¨æˆ·å¯èƒ½å¸Œæœ›ä¿ç•™åŸæ¥çš„ä¹ æƒ¯ã€‚å¯ä»¥è€ƒè™‘åœ¨è®¾ç½®é‡Œé¢å¢åŠ ä¸€ä¸ªé€‰é¡¹ï¼Œè®©ç”¨æˆ·è‡ªè¡Œé€‰æ‹©ã€‚</p>
<h2 id="å°½é‡è®©Native_APPå¤„ç†URL">å°½é‡è®©Native APPå¤„ç†URL</h2><p>æœ‰äº›URLå¯ä»¥ç”±Native APPå¤„ç†ã€‚å¦‚æœç”¨æˆ·å®‰è£…äº†Twitterçš„APPå¹¶ä¸”ç‚¹å‡»äº†Twitterçš„URLï¼Œä»–å¯èƒ½æ›´æœŸæœ›ç”¨Twitter APPæ‰“å¼€ã€‚æ‰€ä»¥åœ¨æ‰“å¼€URLä¹‹å‰ï¼Œæ£€æŸ¥çœ‹çœ‹æ‰‹æœºé‡Œæœ‰æ²¡æœ‰å…¶ä»–APPå¯ä»¥å¤„ç†è¿™ä¸ªURLã€‚</p>
<h2 id="è‡ªå®šä¹‰Toolbaré¢œè‰²">è‡ªå®šä¹‰Toolbaré¢œè‰²</h2><p>å¦‚æœä½ å¸Œæœ›ç”¨æˆ·è§‰å¾—ç½‘é¡µå†…å®¹æ˜¯ä½ çš„APPçš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±å°†Toolbaré¢œè‰²è®¾ä¸ºä½ çš„primaryColorã€‚å¦‚æœå¸Œæœ›æ¸…é™¤çš„è¡¨æ˜ç½‘é¡µå†…å®¹ä¸APPæ— å…³ï¼Œé‚£ä¹ˆé€‰ä¸ªä¸åŒçš„é¢œè‰²å§ã€‚</p>
<h2 id="å¢åŠ ä¸€ä¸ªåˆ†äº«æŒ‰é’®">å¢åŠ ä¸€ä¸ªåˆ†äº«æŒ‰é’®</h2><p>ç”¨æˆ·å¯èƒ½æƒ³è¦æŠŠURLåˆ†äº«ç»™å¥½å‹ï¼Œä½†Custom Tabsé»˜è®¤å¹¶æ²¡æœ‰åˆ†äº«æŒ‰é’®ï¼Œæ‰€ä»¥æœ€å¥½è‡ªå·±åŠ ä¸ªå§ã€‚</p>
<h2 id="è‡ªå®šä¹‰å…³é—­æŒ‰é’®">è‡ªå®šä¹‰å…³é—­æŒ‰é’®</h2><p>Custom Tabså·¦ä¸Šè§’çš„å…³é—­æŒ‰é’®é»˜è®¤æ˜¯ä¸€ä¸ªå‰å‰ã€‚å¦‚æœä½ å¸Œæœ›ç”¨æˆ·æ„Ÿè§‰åˆ°ç½‘é¡µå†…å®¹æ˜¯APPçš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆæœ€å¥½æŠŠå‰å‰æ¢æˆè¿”å›æŒ‰é’®ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.setCloseButtonIcon(BitmapFactory.decodeResource(getResources(), R.drawable.ic_arrow_back));</span><br></pre></td></tr></table></figure>
<h2 id="åˆ†æ¸…å†…éƒ¨é“¾æ¥å’Œå¤–éƒ¨é“¾æ¥">åˆ†æ¸…å†…éƒ¨é“¾æ¥å’Œå¤–éƒ¨é“¾æ¥</h2><p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœç”¨æˆ·åœ¨Twitter APPé‡Œç‚¹å‡»äº†ä¸€ä¸ª<code>http://twitter.com</code>å¼€å¤´çš„URLï¼Œé‚£ä¹ˆåº”è¯¥åœ¨APPå†…éƒ¨å¤„ç†ã€‚Custom Tabsåªåº”ç”¨æ¥å¤„ç†å¤–éƒ¨é“¾æ¥ã€‚</p>
<h2 id="å¤„ç†è¿å‡»">å¤„ç†è¿å‡»</h2><p>å¦‚æœä½ æƒ³åœ¨ç”¨æˆ·ç‚¹å‡»URLåˆ°æ‰“å¼€Custom Tabsä¹‹é—´çš„è¿™æ®µæ—¶é—´åšä¸€ç‚¹å‡†å¤‡å·¥ä½œï¼Œç¡®ä¿ä¸è¦è¶…è¿‡100msï¼Œå¦åˆ™ç”¨æˆ·å¯èƒ½ä¼šè§‰å¾—APPæ²¡æœ‰ååº”è€Œå†æ¬¡ç‚¹å‡»ã€‚</p>
<p>ç„¶è€Œä½ æ‡‚çš„åœ¨Androidä¸Šæ˜¯æ— æ³•å®Œå…¨é¿å…å¡é¡¿çš„ï¼Œæ‰€ä»¥å½“ç”¨æˆ·åå¤ç‚¹å‡»åŒä¸€ä¸ªURLæ—¶ï¼Œä½ åº”è¯¥åªå°†URLæ‰“å¼€ä¸€æ¬¡ã€‚</p>
<h1 id="ç»“å°¾">ç»“å°¾</h1><p>å¦‚æœä½ çš„APPæ˜¯ä½¿ç”¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€URLï¼Œé‚£ä¹ˆèº«ä¸ºä¸€ä¸ªåˆæ ¼çš„å¼€å‘è€…ï¼Œå³ä½¿ä½ çš„APPåªåœ¨å›½å†…ä¸Šæ¶ï¼Œä¹Ÿåº”è¯¥åŠ å…¥Custom Tabsæ”¯æŒã€‚æ¯•ç«Ÿå›½å†…è¿˜æ˜¯æœ‰ä¸€äº›ä¼šç§‘å­¦ä¸Šç½‘çš„ç”¨æˆ·ä½¿ç”¨Chromeçš„ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œ<strong>æˆ‘ä»¬è¿™äº›å¼€å‘è€…å¦‚æœçœ‹åˆ°æœ‰å›½å†…APPä½¿ç”¨äº†Custom Tabsï¼Œä¼šæ¬£æ…°çš„ç‚¹ä¸ªèµï¼</strong></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>è·ç¦»Googleå‘å¸ƒChrome Custom Tabså·²ç»ä¸€å¹´ï¼ŒTwitterã€Mediumç­‰å›½å¤–Appæ—©å·²æ”¯æŒäº†è¿™ä¸ªåŠŸèƒ½ï¼Œä½†é—æ†¾çš„æ˜¯å›½å†…Appé²œæœ‰æ”¯æŒã€‚è¿™ç¯‡æ–‡ç« ä»¥å®˜æ–¹<a href="https://developer.chrome.com/multidevice/an]]>
    </summary>
    
      <category term="chrome" scheme="http://qq157755587.github.io/tags/chrome/"/>
    
      <category term="customtabs" scheme="http://qq157755587.github.io/tags/customtabs/"/>
    
      <category term="Android" scheme="http://qq157755587.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Kotlinåœ¨Androidä¸­çš„åº”ç”¨]]></title>
    <link href="http://qq157755587.github.io/2015/11/14/kotlin-in-android/"/>
    <id>http://qq157755587.github.io/2015/11/14/kotlin-in-android/</id>
    <published>2015-11-14T05:13:52.000Z</published>
    <updated>2015-11-14T07:27:22.000Z</updated>
    <content type="html"><![CDATA[<p>æœ€è¿‘å…¬å¸æ–°å¼€å‘äº†ä¸€ä¸ªæ–°Appï¼Œandroidç¨‹åºå‘˜å°±æˆ‘ä¸€ä¸ªäººï¼Œçˆ±å’‹å†™å’‹å†™~~äºæ˜¯æˆ‘å°è¯•ç”¨Kotlinå®Œæˆäº†è¿™ä¸ªAppã€‚å¼€å‘è¿‡ç¨‹ä¸­è¶Šæ¥è¶Šæ„ŸåŠ¨â€¦â€¦å¤ªå¥½ç”¨äº†ï¼ï¼ï¼è§£å†³äº†androidå¼€å‘ä¸­çš„å¥½å¤šç—›ç‚¹ï¼</p>
<h1 id="dp,_sp,_pxé—´çš„è½¬æ¢">dp, sp, pxé—´çš„è½¬æ¢</h1><p>ä¼ ç»Ÿçš„javaå†™æ³•é€šå¸¸æ˜¯å†™ä¸ªç±»ä¼¼<code>Util.dpToPx(int value)</code>è¿™æ ·çš„æ–¹æ³•ã€‚çœ‹çœ‹Kotlinæ˜¯æ€ä¹ˆé€šè¿‡<a href="https://kotlinlang.org/docs/reference/extensions.html" target="_blank" rel="external">Extension</a>æ¥ä¼˜é›…çš„è§£å†³çš„ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> Int.<span class="title">dpToPx</span><span class="params">()</span>: Int &#123;</span></span><br><span class="line">    <span class="keyword">if</span> (toInt() <span class="keyword">in</span> intArrayOf(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT)) &#123;</span><br><span class="line">        <span class="keyword">return</span> this</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (this * Global.density).toInt() <span class="comment">//è¿™é‡Œçš„Gloabl.densityæ˜¯åœ¨åº”ç”¨å¯åŠ¨æ—¶è·å–çš„</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±å¯ä»¥è¿™æ ·å†™äº†ï¼š<code>params.topMargin = 16.dpTpPx()</code></p>
<p>æ˜¯ä¸æ˜¯æ„ŸåŠ¨åˆ°å“­ğŸ˜­</p>
<h1 id="è®¾ç½®Viewçš„å®½é«˜">è®¾ç½®Viewçš„å®½é«˜</h1><p>å¦‚æœç”¨javaæ¥å†™é€šå¸¸ä¹Ÿæ˜¯ä¼šæœ‰ä¸ªUtilæ–¹æ³•<code>ViewHelper.setSize(View view, int width, int height)</code>ï¼Œæˆ‘æ¯æ¬¡åœ¨ViewHolderä¸­è°ƒç”¨ä¸€å †è¿™æ ·çš„æ–¹æ³•éƒ½è§‰å¾—å¾ˆè›‹ç–¼â€¦â€¦æˆ‘ä»¬çš„æ•‘ä¸–ä¸»æ¥äº†ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> View.<span class="title">setSize</span><span class="params">(width: <span class="typename">Int, height: Int</span>)</span> &#123;</span></span><br><span class="line">    <span class="variable"><span class="keyword">val</span> params</span> = layoutParams</span><br><span class="line">    params.width = width</span><br><span class="line">    params.height = height</span><br><span class="line">    layoutParams = params</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„è¿™é‡Œçš„<code>layoutParams</code>æ˜¯Kotlinå°†<code>setLayoutParams()</code>å’Œ<code>getLayoutParams()</code>è‡ªåŠ¨è½¬ä¸ºäº†<a href="https://kotlinlang.org/docs/reference/properties.html" target="_blank" rel="external">Property</a>ï¼Œå†™è¿‡C#çš„åº”è¯¥ä¸ä¼šé™Œç”Ÿã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„å†™ä»£ç äº†~<code>yourView.setSize(100, 100)</code></p>
<h1 id="Viewçš„åŠ¨ç”»">Viewçš„åŠ¨ç”»</h1><p>æ¯æ¬¡å†™Animationéƒ½æ˜¯ä¸€ä¸ªå¤´ä¸¤ä¸ªå¤§â€¦â€¦è¿™å›æˆ‘ä»¬ä¸çœ‹javaäº†ï¼Œç›´æ¥ä¸ŠKotlinä»£ç ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> View.<span class="title">animateTopMargin</span><span class="params">(valueFromInDP: <span class="typename">Int, valueToInDP: Int, duration: Long</span> = 300)</span> &#123;</span></span><br><span class="line">    <span class="variable"><span class="keyword">val</span> animation</span> = <span class="keyword">object</span>: Animation() &#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">applyTransformation</span><span class="params">(interpolatedTime: <span class="typename">Float, t: Transformation?</span>)</span> &#123;</span></span><br><span class="line">            <span class="variable"><span class="keyword">val</span> params</span> = layoutParams <span class="keyword">as</span> ViewGroup.MarginLayoutParams</span><br><span class="line">            <span class="variable"><span class="keyword">val</span> from</span> = valueFromInDP.dpToPx()</span><br><span class="line">            <span class="variable"><span class="keyword">val</span> to</span> = valueToInDP.dpToPx()</span><br><span class="line">            params.topMargin = from + ((to - from) * interpolatedTime).toInt()</span><br><span class="line">            layoutParams = params</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    animation.duration = duration</span><br><span class="line">    startAnimation(animation)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å“‡ï¼Œdurationè¿˜è´´å¿ƒçš„è®¾äº†ä¸ªé»˜è®¤å€¼å‘¢ï¼ç„¶åå°±å¯ä»¥è¿™æ ·å†™äº†~<code>yourView.animateTopMargin(16, 32)</code>æˆ–è€…ä½ æƒ³æŠŠdurationè®¾é•¿ä¸€ç‚¹<code>yourView.animateTopMargin(16, 32, 500)</code></p>
<h1 id="è®©Frescoæ›´æ˜“ç”¨">è®©Frescoæ›´æ˜“ç”¨</h1><p><a href="http://github.com/facebook/fresco" target="_blank" rel="external">Fresco</a>æ˜¯Facebookå‡ºå“çš„ç½‘ç»œå›¾ç‰‡åŠ è½½åº“ï¼Œå®ç°äº†è®¸å¤šåœ¨androidä¸Šéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ã€‚æ¯”å¦‚<a href="http://frescolib.org/docs/requesting-multiple-images.html#_" target="_blank" rel="external">Multi-URI</a>åŠŸèƒ½å¯ä»¥ä¼˜å…ˆæ˜¾ç¤ºä½åˆ†è¾¨ç‡çš„å›¾ç‰‡ï¼Œç­‰é«˜åˆ†è¾¨ç‡çš„å›¾ç‰‡ä¸‹è½½å®Œæˆåå†è¿›è¡Œæ›¿æ¢ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šå¤ªå¤ªå¤ªæœ‰ç”¨äº†ï¼Œå°±æ˜¯å†™èµ·æ¥æœ‰ç‚¹è›‹ç–¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Uri lowResUri, highResUri;</span><br><span class="line">DraweeController controller = Fresco.newDraweeControllerBuilder()</span><br><span class="line">    .setLowResImageRequest(ImageRequest.fromUri(lowResUri))</span><br><span class="line">    .setImageRequest(ImageRequest.fromUri(highResUri))</span><br><span class="line">    .setOldController(mSimpleDraweeView.getController())</span><br><span class="line">    .build();</span><br><span class="line">mSimpleDraweeView.setController(controller);</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯æˆ‘åˆç¥­å‡ºäº†ç¥å™¨Extension</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> SimpleDraweeView.<span class="title">setMultiUri</span><span class="params">(lowResUri: <span class="typename">Uri, highResUri: Uri</span>)</span> &#123;</span></span><br><span class="line">    <span class="variable"><span class="keyword">val</span> newController</span> = Fresco.newDraweeControllerBuilder()</span><br><span class="line">            .setLowResImageRequest(ImageRequest.fromUri(lowResUri))</span><br><span class="line">            .setImageRequest(ImageRequest.fromUri(highResUri))</span><br><span class="line">            .setOldController(controller)</span><br><span class="line">            .build();</span><br><span class="line">    controller = newController</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ€ä¹ˆä½¿ç”¨æˆ‘å°±ä¸å†™äº†ï¼Œå¤§å®¶éƒ½çŸ¥é“äº†:smiley:</p>
<h1 id="ç„•ç„¶ä¸€æ–°çš„SharedPreference">ç„•ç„¶ä¸€æ–°çš„SharedPreference</h1><p>ä½ çœ‹åˆ°è¿™é‡Œå¯èƒ½è§‰å¾—ä¸è¿‡æ˜¯æ‰©å±•æ–¹æ³•å˜›ï¼ŒObj-Cä¹Ÿå¯ä»¥åšåˆ°å•Šï¼Œæ²¡ä»€ä¹ˆå˜›ã€‚å“ˆå“ˆå“ˆå“ˆå›¾æ ·å›¾æ£®ç ´ï¼æœ‰è¯·<a href="https://kotlinlang.org/docs/reference/delegated-properties.html" target="_blank" rel="external">Delegated Properties</a>ï¼ä¸‹é¢è¿™æ®µä»£ç æ¥æºäº<a href="http://google.com/+OmarMiatello" target="_blank" rel="external">Omar Miatello</a>åœ¨ä»Šå¹´ç±³å…°çš„GDG DevFestçš„<a href="https://goo.gl/7Vhy0s" target="_blank" rel="external">æ¼”è®²</a></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppPreferences</span></span>(<span class="keyword">private</span> <span class="variable"><span class="keyword">val</span> context</span>: Context) &#123;</span><br><span class="line">    <span class="variable"><span class="keyword">val</span> preferences</span>: SharedPreferences = PreferenceManager.getDefaultSharedPreferences(context)</span><br><span class="line">    <span class="variable"><span class="keyword">var</span> userName by PreferenceDelegates.string(defaultValue</span> = context.getString(R.string.user_name))</span><br><span class="line">    <span class="variable"><span class="keyword">var</span> password by PreferenceDelegates.string()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">object PreferenceDelegates &#123;</span><br><span class="line">    public fun string(defaultValue</span>: String? = <span class="literal">null</span>): ReadWriteProperty<span class="type">&lt;AppPreferences, String?&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> PrefString(defaultValue)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">PrefString</span></span>(<span class="keyword">private</span> <span class="variable"><span class="keyword">val</span> defaultValue</span>: String?) : ReadWriteProperty<span class="type">&lt;AppPreferences, String?&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getValue</span><span class="params">(thisRef: <span class="typename">AppPreferences, property: KProperty&lt;*&gt;</span>)</span>: String? &#123;</span></span><br><span class="line">        <span class="keyword">return</span> thisRef.preferences.getString(property.name, defaultValue)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">setValue</span><span class="params">(thisRef: <span class="typename">AppPreferences, property: KProperty&lt;*&gt;, value: String?</span>)</span> &#123;</span></span><br><span class="line">        thisRef.preferences.edit().putString(property.name, value).apply()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Hmmï¼Œä¹ä¸€çœ‹æœ‰ç‚¹æ‘¸ä¸ç€å¤´è„‘å‘¢â€¦â€¦ç®€å•çš„è®²ï¼ŒAppPreferencesè¿™ä¸ªclassé‡Œé¢æœ‰ä¸¤ä¸ªdelegate propertyï¼Œåˆ†åˆ«æ˜¯userNameå’Œpasswordã€‚ä»–ä»¬çš„getå’Œsetæ–¹æ³•åˆ†åˆ«å¯¹åº”äº†SharedPreferenceä¸­çš„getStringå’ŒsetStringæ–¹æ³•ã€‚çº³å°¼ï¼Ÿè¿™ä¹ˆç¥å¥‡ï¼Ÿï¼Ÿï¼Ÿæ¥ç€å¾€ä¸‹çœ‹</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span>: <span class="typename">Application</span></span>() &#123;</span><br><span class="line">    <span class="variable"><span class="keyword">val</span> pref by lazy &#123; AppPreferences(this) &#125;</span><br><span class="line">    </span><br><span class="line">    override fun onCreate() &#123;</span><br><span class="line">        super.onCreate()</span><br><span class="line">        // å…¶ä»–ä»£ç </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨Applicationä¸­å®šä¹‰äº†<code>pref</code>ï¼Œæ³¨æ„å®ƒè¢«<code>by lazy</code>ä¿®é¥°äº†ï¼Œè¿™æ ·å®ƒå°±åªåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™åˆå§‹åŒ–ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Ÿ</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseActivity</span>: <span class="typename">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="variable"><span class="keyword">val</span> app by lazy &#123; application as App &#125;</span><br><span class="line">    <span class="keyword">val</span> pref by lazy &#123; app.pref &#125;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬åœ¨æ‰€æœ‰Activityçš„çˆ¶ç±»ä¸­å¼•å…¥äº†prefï¼Œå³AppPreferencesçš„å®ä¾‹ã€‚ç„¶åâ€¦â€¦å°±å¯ä»¥çˆ½äº†~~</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyActivity</span>: <span class="typename">BaseActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="typename">Bundle?</span>)</span> &#123;</span></span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        </span><br><span class="line">        pref.userName = <span class="string">"Who"</span></span><br><span class="line">        pref.password = <span class="string">"You"</span></span><br><span class="line">        Log.d(<span class="string">"userName"</span>, pref.userName)</span><br><span class="line">        Log.d(<span class="string">"password"</span>, pref.password)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹åˆ°æ²¡æœ‰ï¼Œç”¨èµ·æ¥ç®€ç›´å’Œfieldä¸€æ¯›ä¸€æ ·ï¼å†ä¹Ÿä¸ç”¨å†™<code>pref.edit().putString(&quot;userName&quot;, &quot;Who&quot;).apply()</code>äº†ï¼ï¼ï¼è€æ¿å†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘æŠŠSharedPreferenceçš„keyå†™é”™äº†ğŸ˜‚</p>
<h1 id="Lambdas">Lambdas</h1><p>è¿™ä¸ªè¯é¢˜å¯å°±å¤§äº†ï¼Œä¸€æœ¬ä¹¦éƒ½è®²ä¸å®Œï¼Œä¸¾ä¸ªä¾‹å­å¥½äº†ã€‚<a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="external">RxJava</a>ç°åœ¨å¾ˆç«ï¼Œ<a href="https://github.com/rengwuxian" target="_blank" rel="external">å…‰å¤´å“¥</a>å†™äº†ä¸€ç¯‡å¾ˆå¥½çš„<a href="http://gank.io/post/560e15be2dca930e00da1083" target="_blank" rel="external">æ–‡ç« </a>ä»‹ç»äº†RxJavaåœ¨androidä¸­çš„åº”ç”¨ã€‚æŠ„ä¸€æ®µä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">getUser(userId)</span><br><span class="line">    .doOnNext(<span class="keyword">new</span> Action1&lt;User&gt;() &#123;</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">            processUser(user);</span><br><span class="line">        &#125;)</span><br><span class="line">    .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">    .subscribe(<span class="keyword">new</span> Observer&lt;User&gt;() &#123;</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">            userView.setUser(user);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable error)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// Error handling</span></span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>å—¯ï¼Œé“¾å¼è°ƒç”¨ï¼Œå¾ˆæ¸…æ™°ï¼Œä½†ç”¨Kotlinè¿˜å¯ä»¥æ›´ç®€æ´ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">getUser(userId)</span><br><span class="line">    .doOnNext&#123; user -&gt; processUser(user) &#125;</span><br><span class="line">    .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">    .subscribe(&#123;</span><br><span class="line">        user -&gt; userView.setUser(user)</span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        error -&gt; <span class="comment">// Error handling</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<p>Done!æ”¶æ‹¾ä¸œè¥¿ä¸‹ç­å›å®¶~</p>
<h1 id="é£é™©">é£é™©</h1><p>æˆ‘çŸ¥é“ä½ åœ¨æ‹…å¿ƒä»€ä¹ˆã€‚Kotlinç›®å‰è¿˜æ˜¯betaç‰ˆï¼Œç”¨äºæ­£å¼é¡¹ç›®è¦è¯„ä¼°é£é™©ã€‚äº‹å®ä¸Šåœ¨ç¬¬ä¸€ä¸ªbetaç‰ˆä¸­å°±å‡ºç°äº†åœ¨android 4.3è®¾å¤‡ä¸Šæ— æ³•å®‰è£…çš„bugï¼Œå¥½åœ¨å®˜æ–¹å¾ˆå¿«å°±ä¿®å¤äº†ã€‚æ€ä¹ˆè®²å‘¢ï¼Œè¿™æ˜¯éœ€è¦é¡¹ç›®ç»„å…¨ä½“æˆå‘˜ä¸€èµ·è¯„ä¼°çš„é—®é¢˜ã€‚æˆ‘ä¹‹æ‰€ä»¥æ•¢åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œä¸€æ˜¯å› ä¸ºé¡¹ç›®æ¯”è¾ƒç®€å•ï¼Œä¸‡ä¸€é‡åˆ°ä¸å¯è§£å†³çš„é—®é¢˜å¯ä»¥æ”¹ç”¨javaå†™ï¼Œåæ­£Kotlinå’Œjavaå¯ä»¥æ— ç¼æ··ç”¨ï¼›äºŒæ˜¯å› ä¸ºç¨‹åºå‘˜å°±æˆ‘ä¸€ä¸ªäººï¼Œèƒ†å­ç²—å•Šå“ˆå“ˆå“ˆå“ˆ~</p>
<h1 id="æ„Ÿæƒ³">æ„Ÿæƒ³</h1><p>æ•´ä¸ªé¡¹ç›®åšä¸‹æ¥è®©æˆ‘æ„Ÿåˆ°å¾ˆæ„‰æ‚¦ï¼Œä»£ç çš„ä¼˜é›…è¶³ä»¥è¯´æœæˆ‘å†’ä¸€ç‚¹ç‚¹é£é™©ã€‚å¼€å‘è¿‡ç¨‹ä¸­æˆ‘å¸¸å¸¸åœ¨æƒ³ï¼Œè¦æ˜¯æœ‰ä¸€ä¸ªåŒ…å«å„ç§æ‰©å±•æ–¹æ³•çš„libraryå°±å¥½äº†ï¼Œæˆ‘å°±ä¸ç”¨è‡ªå·±é€ å°è½®å­äº†ã€‚ä½†è½¬å¿µä¸€ä¸‹ï¼Œæˆ‘çœŸçš„éœ€è¦ä¸€ä¸ªå®Œæ•´çš„libraryå—ï¼Ÿé‚£å¿…ç„¶ä¼šåƒ<a href="https://github.com/google/guava" target="_blank" rel="external">Guava</a>ä¸€æ ·æˆä¸ºä¸€ä¸ªå·¨æ— éœ¸ï¼Œä½†å®é™…ç”¨åˆ°çš„åŠŸèƒ½å¯èƒ½åªæœ‰10%ã€‚åœ¨Kotlinçš„<a href="http://kotlinslackin.herokuapp.com/" target="_blank" rel="external">å®˜æ–¹Slack</a>é‡Œ<a href="https://github.com/jakewharton" target="_blank" rel="external">Jake Wharton</a>ï¼ˆæ²¡é”™å°±æ˜¯é‚£ä¸ªå¤§ç¥ï¼‰æäº†ä¸€ä¸ªæœ‰è¶£çš„æ€è·¯ï¼šåœ¨ä¸€ä¸ªgité‡Œæ”¾äº†å¾ˆå¤šä¸åŒç±»åˆ«çš„æ‰©å±•æ–¹æ³•æ–‡ä»¶ï¼ˆæ¯”å¦‚ViewExt.ktï¼ŒIntExt.ktï¼‰ï¼Œéœ€è¦å“ªä¸ªæ–‡ä»¶å°±æŠŠå®ƒpullä¸‹æ¥ï¼Œè€Œä¸æ˜¯compileæ•´ä¸ªjaråŒ…ã€‚å¦‚æœèƒ½ç”¨gradleå®ç°å°±å¤ªæ–¹ä¾¿äº†ğŸ˜†</p>
<h1 id="è¡¥å……èµ„æ–™">è¡¥å……èµ„æ–™</h1><p><a href="http://antonioleiva.com/" target="_blank" rel="external">Antonio Leiva</a>å†™äº†ä¸€æœ¬ä¹¦<a href="http://antonioleiva.com/kotlin-android-developers-book/" target="_blank" rel="external">Kotlin for Android Developers</a>ï¼Œä»·æ ¼å®æƒ å¹²è´§æ»¡æ»¡ï¼Œå€¼å¾—è´­ä¹°ã€‚é…å¥—çš„æºç åœ¨<a href="https://github.com/antoniolg/Kotlin-for-Android-Developers" target="_blank" rel="external">https://github.com/antoniolg/Kotlin-for-Android-Developers</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ€è¿‘å…¬å¸æ–°å¼€å‘äº†ä¸€ä¸ªæ–°Appï¼Œandroidç¨‹åºå‘˜å°±æˆ‘ä¸€ä¸ªäººï¼Œçˆ±å’‹å†™å’‹å†™~~äºæ˜¯æˆ‘å°è¯•ç”¨Kotlinå®Œæˆäº†è¿™ä¸ªAppã€‚å¼€å‘è¿‡ç¨‹ä¸­è¶Šæ¥è¶Šæ„ŸåŠ¨â€¦â€¦å¤ªå¥½ç”¨äº†ï¼ï¼ï¼è§£å†³äº†androidå¼€å‘ä¸­çš„å¥½å¤šç—›ç‚¹ï¼</p>
<h1 id="dp,_sp,_pxé—´çš„è½¬æ¢">dp, sp, pxé—´]]>
    </summary>
    
      <category term="Kotlin" scheme="http://qq157755587.github.io/categories/Kotlin/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å¿«é€Ÿè‡ªå®šä¹‰tableViewCell]]></title>
    <link href="http://qq157755587.github.io/2015/08/19/custom-table-view-cell/"/>
    <id>http://qq157755587.github.io/2015/08/19/custom-table-view-cell/</id>
    <published>2015-08-19T12:47:01.000Z</published>
    <updated>2015-08-19T13:11:43.000Z</updated>
    <content type="html"><![CDATA[<p>æœ€è¿‘å› ä¸ºå·¥ä½œéœ€è¦å¼€å§‹å­¦ä¹ iOSã€‚åœ¨ç½‘ä¸Šæœè‡ªåŠ¨å®šä¹‰tableViewCellï¼Œå‡ºæ¥çš„ç»“æœéƒ½æ˜¯è¦æ–°å»ºxibæ–‡ä»¶å’Œå¯¹åº”çš„classï¼Œç„¶ååœ¨ä¸Šé¢æ·»åŠ æ§ä»¶ï¼Œå†æ³¨å†Œåˆ°tableViewControllerä¸­ã€‚<br>è¿™æ ·åšä¸€æ¥å¾ˆç¹çï¼ŒäºŒæ¥å¾ˆå®¹æ˜“åœ¨ç»‘å®šoutletçš„æ—¶å€™æŠ›å¼‚å¸¸ï¼ˆæˆ‘å°±é‡åˆ°äº†ï¼‰ã€‚åŒäº‹å‘Šè¯‰æˆ‘ä¸€ä¸ªå¿«æ·çš„åŠæ³•ã€‚</p>
<p>1ã€ç›´æ¥åœ¨StoryBoardé‡Œé¢å°†æ§ä»¶æ·»åŠ åˆ°Prototype Cellä¸­ã€‚</p>
<p><img src="tableViewCell.png" alt="Image of tableViewCell"></p>
<p>2ã€æ–°å¢ä¸€ä¸ªClassï¼ˆæ¯”å¦‚MyTableViewCellï¼‰ç»§æ‰¿UITableViewCellã€‚</p>
<p>3ã€å°†Prototype Cellçš„Classè®¾ä¸ºMyTableViewCellã€‚</p>
<p>4ã€æŒ‰ä½<em>control</em>å°†æ§ä»¶æ‹–åˆ°MyTableViewCellä¸­ï¼Œæ·»åŠ outletã€‚<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic, strong) IBOutlet UILable *label;&#10;@property (nonatomic, strong) IBOutlet UIImageView *image;</span><br></pre></td></tr></table></figure></p>
<p>5ã€ç›´æ¥è°ƒç”¨<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MyTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CELL_IDENTITY forIndexPath:indexPath];</span><br></pre></td></tr></table></figure></p>
<p>æå®š~</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ€è¿‘å› ä¸ºå·¥ä½œéœ€è¦å¼€å§‹å­¦ä¹ iOSã€‚åœ¨ç½‘ä¸Šæœè‡ªåŠ¨å®šä¹‰tableViewCellï¼Œå‡ºæ¥çš„ç»“æœéƒ½æ˜¯è¦æ–°å»ºxibæ–‡ä»¶å’Œå¯¹åº”çš„classï¼Œç„¶ååœ¨ä¸Šé¢æ·»åŠ æ§ä»¶ï¼Œå†æ³¨å†Œåˆ°tableViewControllerä¸­ã€‚<br>è¿™æ ·åšä¸€æ¥å¾ˆç¹çï¼ŒäºŒæ¥å¾ˆå®¹æ˜“åœ¨ç»‘å®šoutletçš„æ—¶å€™æŠ›å¼‚å¸¸ï¼ˆæˆ‘å°±é‡åˆ°äº†]]>
    </summary>
    
      <category term="tableViewCell" scheme="http://qq157755587.github.io/tags/tableViewCell/"/>
    
      <category term="iOS" scheme="http://qq157755587.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Kotlinå­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰æ§åˆ¶æµç¨‹]]></title>
    <link href="http://qq157755587.github.io/2015/08/08/learning-kotlin-3/"/>
    <id>http://qq157755587.github.io/2015/08/08/learning-kotlin-3/</id>
    <published>2015-08-08T06:40:18.000Z</published>
    <updated>2015-08-08T08:06:59.000Z</updated>
    <content type="html"><![CDATA[<h1 id="If_Expression">If Expression</h1><p>åœ¨Kotlinä¸­ï¼Œ<strong>if</strong>æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒæœ‰è¿”å›ç±»å‹ã€‚å› æ­¤Kotlinä¸­ä¸å†éœ€è¦ä¸‰å…ƒè¡¨è¾¾å¼ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">var</span> max</span> = <span class="keyword">if</span> (a &gt; b) a <span class="keyword">else</span> b</span><br></pre></td></tr></table></figure>
<p>ifåˆ†æ”¯ä¹Ÿå¯ä»¥æ˜¯ä»£ç å—ï¼ˆblocksï¼‰ï¼Œä»£ç å—çš„æœ«å°¾æ˜¯è¿”å›å€¼ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">var</span> max</span> = <span class="keyword">if</span> (a &gt; b) &#123;</span><br><span class="line">  print(<span class="string">"Choose a"</span>)</span><br><span class="line">  a <span class="comment">// aä¼šè¢«èµ‹å€¼ç»™max</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  print(<span class="string">"Choose b"</span>)</span><br><span class="line">  b <span class="comment">// bä¼šè¢«èµ‹å€¼ç»™max</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="When_Expression">When Expression</h1><p><strong>when</strong>æ›¿ä»£äº†switchè¯­å¥ï¼Œç®€å•çš„ä¾‹å­åƒè¿™æ ·ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">when</span> (x) &#123;</span><br><span class="line">  <span class="number">1</span> -&gt; print(<span class="string">"x == 1"</span>)</span><br><span class="line">  <span class="number">2</span> -&gt; print(<span class="string">"x == 2"</span>)</span><br><span class="line">  <span class="keyword">else</span> -&gt; &#123;</span><br><span class="line">    print(<span class="string">"x is neither 1 or 2"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå¤šä¸ªåˆ†æ”¯ä½¿ç”¨åŒæ ·çš„å¤„ç†é€»è¾‘ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨é€—å·å°†å®ƒä»¬ç»“åˆèµ·æ¥ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">when</span> (x) &#123;</span><br><span class="line">  <span class="number">1</span>, <span class="number">2</span> -&gt; print(<span class="string">"x == 1 or x == 2"</span>)</span><br><span class="line">  <span class="keyword">else</span> -&gt; print(<span class="string">"otherwise"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ†æ”¯ä¸­é™¤äº†ä½¿ç”¨å¸¸é‡ï¼ˆä¸Šä¾‹ä¸­çš„1ã€2ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å‡½æ•°ï¼ˆarbitrary expressionsï¼‰ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">when</span> (x) &#123;</span><br><span class="line">  parseInt(s) -&gt; print(<span class="string">"s encodes x"</span>)</span><br><span class="line">  esle -&gt; print(<span class="string">"s does not encode x"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥ç”¨<strong>in</strong>æˆ–<strong>!in</strong>åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦åœ¨ä¸€ä¸ªèŒƒå›´ï¼ˆrangeï¼‰æˆ–é›†åˆï¼ˆcollectionï¼‰ä¸­ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">when</span> (x) &#123;</span><br><span class="line">  <span class="keyword">in</span> <span class="number">1.</span>..<span class="number">10</span> -&gt; print(<span class="string">"x is in the range"</span>)</span><br><span class="line">  <span class="keyword">in</span> validNumbers -&gt; print(<span class="string">"x is valid"</span>)</span><br><span class="line">  !<span class="keyword">in</span> <span class="number">10.</span>..<span class="number">20</span> -&gt; print(<span class="string">"x is outside the range"</span>)</span><br><span class="line">  <span class="keyword">else</span> -&gt; print(<span class="string">"none of the above"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜å¯ä»¥ç”¨<strong>is</strong>æˆ–<strong>!is</strong>æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯æŸä¸ªç±»å‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">val</span> hasPrefix</span> = <span class="keyword">when</span>(x) &#123;</span><br><span class="line">  <span class="keyword">is</span> String -&gt; x.startsWith(<span class="string">"prefix"</span>) <span class="comment">// æ³¨æ„è¿™é‡Œså·²ç»è¢«è‡ªåŠ¨è½¬ä¸ºStringç±»å‹äº†</span></span><br><span class="line">  <span class="keyword">else</span> -&gt; <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>whenè¿˜å¯ä»¥ç”¨æ¥å–ä»£<strong>if-else if</strong>ã€‚å¦‚æœæ²¡æœ‰ä¼ å‚æ•°ï¼Œé‚£ä¹ˆåˆ†æ”¯æ¡ä»¶å°±æ˜¯ç®€å•çš„booleanè¡¨è¾¾å¼ï¼Œå½“æ¡ä»¶ä¸ºtrueæ—¶åˆ†æ”¯å°±ä¼šè¢«æ‰§è¡Œï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">when</span> &#123;</span><br><span class="line">  x.isOdd() -&gt; print(<span class="string">"x is odd"</span>)</span><br><span class="line">  x.isEven() -&gt; print(<span class="string">"x is even"</span>)</span><br><span class="line">  <span class="keyword">else</span> -&gt; print(<span class="string">"x is funny"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="For_Loops">For Loops</h1><p>æ„Ÿè§‰æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œè·ŸJavaä¸€æ ·ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (item <span class="keyword">in</span> collection)</span><br><span class="line">  print(item)</span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> array.indices)</span><br><span class="line">  print(array[i])</span><br></pre></td></tr></table></figure>
<h1 id="While_Loops">While Loops</h1><p>ä¹Ÿæ²¡ä»€ä¹ˆç‰¹åˆ«çš„ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (x &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  x--</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="variable"><span class="keyword">val</span> y</span> = retrieveData()</span><br><span class="line">&#125; <span class="keyword">while</span> (y != <span class="literal">null</span>) <span class="comment">// æ³¨æ„è™½ç„¶yæ˜¯åœ¨å¤§æ‹¬å·å†…éƒ¨å®šä¹‰çš„ï¼Œä½†è¿™é‡Œä»ç„¶å¯ä»¥è®¿é—®åˆ°</span></span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="If_Expression">If Expression</h1><p>åœ¨Kotlinä¸­ï¼Œ<strong>if</strong>æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒæœ‰è¿”å›ç±»å‹ã€‚å› æ­¤Kotlinä¸­ä¸å†éœ€è¦ä¸‰å…ƒè¡¨è¾¾å¼ã€‚</p>
<figure class="highlight kotli]]>
    </summary>
    
      <category term="for" scheme="http://qq157755587.github.io/tags/for/"/>
    
      <category term="if" scheme="http://qq157755587.github.io/tags/if/"/>
    
      <category term="when" scheme="http://qq157755587.github.io/tags/when/"/>
    
      <category term="while" scheme="http://qq157755587.github.io/tags/while/"/>
    
      <category term="Kotlin" scheme="http://qq157755587.github.io/categories/Kotlin/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Kotlinå­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰åŸºæœ¬ç±»å‹]]></title>
    <link href="http://qq157755587.github.io/2015/07/28/learning-kotlin-2/"/>
    <id>http://qq157755587.github.io/2015/07/28/learning-kotlin-2/</id>
    <published>2015-07-28T10:31:26.000Z</published>
    <updated>2015-07-30T09:51:37.000Z</updated>
    <content type="html"><![CDATA[<p>å¦‚æœä½ å­¦è¿‡Rubyï¼Œä½ ä¸€å®šçŸ¥é“â€œä¸‡ç‰©çš†å¯¹è±¡â€ã€‚Kotlinä¸­ä¹Ÿä¸€æ ·ã€‚å³ä¾¿æ•°å­—(Numbers)åœ¨Kotlinä¸­æ˜¯åŸºæœ¬ç±»å‹ï¼Œä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š<code>123.toString()</code></p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹Kotlinä¸­çš„åŸºæœ¬ç±»å‹ã€‚</p>
<h1 id="Numbers">Numbers</h1><p>Kotlinæä¾›çš„æ•°å­—ç±»å‹å’ŒJavaå¾ˆåƒï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Type</strong></th>
<th style="text-align:center"><strong>Bitwidth</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Double</td>
<td style="text-align:center">64</td>
</tr>
<tr>
<td style="text-align:center">Float</td>
<td style="text-align:center">32</td>
</tr>
<tr>
<td style="text-align:center">Long</td>
<td style="text-align:center">64</td>
</tr>
<tr>
<td style="text-align:center">Int</td>
<td style="text-align:center">32</td>
</tr>
<tr>
<td style="text-align:center">Short</td>
<td style="text-align:center">16</td>
</tr>
<tr>
<td style="text-align:center">Byte</td>
<td style="text-align:center">8</td>
</tr>
</tbody>
</table>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå®šä¹‰Longå½¢è¦ç”¨å¤§å†™Lï¼š<strong>123L</strong></p>
<p>è€Œ16è¿›åˆ¶å’ŒäºŒè¿›åˆ¶åˆ™å’ŒJavaä¸€æ ·ï¼š<strong>0x0F</strong> <strong>0b0101</strong></p>
<p>8è¿›åˆ¶åˆ™ä¸æ”¯æŒã€‚</p>
<p>æµ®ç‚¹å‹å’ŒJavaä¸€æ ·ï¼Œç±»ä¼¼<strong>123.45</strong>é»˜è®¤ä¸ºDoubleç±»å‹ï¼Œæƒ³è¦Floatç±»å‹åˆ™åº”å†™æˆ<strong>123.45f</strong></p>
<p>åœ¨Javaå¹³å°ä¸­ï¼ŒNumberæ˜¯åŸºæœ¬ç±»å‹ã€‚å¦‚æœéœ€è¦ä¸€ä¸ªå¯ç©ºçš„æ•°å­—ï¼ˆæ¯”å¦‚Int?ï¼‰æˆ–è€…æ³›å‹ï¼Œæ•°å­—å°±ä¼šè¢«è£…ç®±(boxed)ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">val</span> a</span>: <span class="typename">Int</span> = <span class="number">10000</span></span><br><span class="line">print(a == a) <span class="comment">// Prints 'true'</span></span><br><span class="line">print(a === a) <span class="comment">// Prints 'true'</span></span><br><span class="line"><span class="variable"><span class="keyword">val</span> boxedA</span>: <span class="typename">Int</span>? = a</span><br><span class="line"><span class="variable"><span class="keyword">val</span> anotherBoxedA</span>: <span class="typename">Int</span>? = a</span><br><span class="line">print(boxedA == anotherBoxedA) <span class="comment">// Prints 'true'</span></span><br><span class="line">print(boxedA === anotherBoxedA) <span class="comment">// !!!Prints 'false'!!!</span></span><br></pre></td></tr></table></figure>
<p><code>==</code>ç›¸å½“äºè°ƒç”¨<code>equals</code>æ–¹æ³•ã€‚è€Œ<code>===</code>ç›¸å½“äºJavaä¸­çš„<code>==</code>ï¼Œç”¨æ¥æ¯”è¾ƒå¼•ç”¨å¯¹è±¡ã€‚</p>
<p>æ³¨æ„åœ¨å®˜æ–¹çš„<a href="http://kotlinlang.org/docs/reference/basic-types.html#representation" target="_blank" rel="external">Reference</a>ä¸­ç”¨çš„æ˜¯å³å°†è¢«deprecatedçš„<code>identityEquals</code>ï¼Œä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœï¼Œè¯¦æƒ…å‚çœ‹ <a href="http://stackoverflow.com/questions/31666155/kotlins-identityequals-not-working-as-expected" target="_blank" rel="external">http://stackoverflow.com/questions/31666155/kotlins-identityequals-not-working-as-expected</a></p>
<p>Kotlinä¸­ï¼Œæ•°å­—ç±»å‹<strong>ä¸èƒ½</strong>åƒJavaä¸€æ ·éšå¼(implicitly)è½¬æ¢ç±»å‹ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">val</span> a</span>:<span class="typename">Int</span>? = <span class="number">1</span></span><br><span class="line"><span class="variable"><span class="keyword">val</span> b</span>:<span class="typename">Long</span>? = a <span class="comment">// è¿™é‡Œä¼šç¼–è¯‘æŠ¥é”™ï¼ŒIntä¸èƒ½è½¬æ¢æˆLong</span></span><br><span class="line">print(a == b) <span class="comment">// è¿™é‡Œä¼šç¼–è¯‘æŠ¥é”™ï¼ŒIntå’ŒLongä¸èƒ½è¿›è¡Œæ¯”è¾ƒ</span></span><br></pre></td></tr></table></figure>
<p>è€Œæ‰€æœ‰çš„æ•°å­—ç±»å‹éƒ½æœ‰å¦‚ä¸‹æ˜¾ç¤ºæ–¹æ³•ï¼š</p>
<ul>
<li>toByte()</li>
<li>toShort()</li>
<li>toInt()</li>
<li>toLong()</li>
<li>toFloat()</li>
<li>toDouble()</li>
<li>toChar()</li>
</ul>
<p>å†™æƒ¯Javaçš„äººå¯èƒ½è§‰å¾—è¿™æ ·ä¼šå¾ˆä¸æ–¹ä¾¿ï¼Œä½†äº‹æƒ…ä¹Ÿæ²¡æœ‰é‚£ä¹ˆç³Ÿç³•ã€‚å› ä¸ºè¿ç®—ç¬¦å¯ä»¥å¸®æˆ‘ä»¬éšå¼çš„è½¬æ¢æ•°å­—ç±»å‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">val</span> l</span> = <span class="number">1.</span>toLong() + <span class="number">3</span> <span class="comment">// Long + Int =&gt; Long</span></span><br></pre></td></tr></table></figure>
<p>ä»…Intå’ŒLongå¯ä»¥è¿›è¡Œä½è¿ç®—ã€‚è¿ç®—ç¬¦ä¸Javaä¸åŒï¼š</p>
<ul>
<li>shl(bits) æœ‰ç¬¦å·çš„å·¦ä½ç§»ï¼Œåœ¨Javaä¸­æ˜¯<code>&lt;&lt;</code></li>
<li>shr(bits) æœ‰ç¬¦å·çš„å³ä½ç§»ï¼Œåœ¨Javaä¸­æ˜¯<code>&gt;&gt;</code></li>
<li>ushr(bits) æ— ç¬¦å·çš„å³ä½ç§»ï¼Œåœ¨Javaä¸­æ˜¯<code>&gt;&gt;&gt;</code></li>
<li>and(bits) ä¸ï¼Œåœ¨Javaä¸­æ˜¯<code>&amp;</code></li>
<li>or(bits) æˆ–ï¼Œåœ¨Javaä¸­æ˜¯<code>|</code></li>
<li>xor(bits) å¼‚æˆ–ï¼Œåœ¨Javaä¸­æ˜¯<code>^</code></li>
<li>inv() éï¼Œåœ¨Javaä¸­æ˜¯<code>~</code></li>
</ul>
<h1 id="Characters">Characters</h1><p>Intä¸èƒ½ç›´æ¥è½¬ä¸ºCharï¼Œä¸‹é¢çš„ä»£ç ä¼šç¼–è¯‘æŠ¥é”™ï¼š</p>
<p><code>val a:Char = 1</code></p>
<p>ä½†æ˜¯Charå¯ä»¥é€šè¿‡<code>toInt()</code>æ–¹æ³•è½¬ä¸ºIntã€‚</p>
<p>åŒæ•°å­—ä¸€æ ·ï¼Œå¦‚æœéœ€è¦ä¸€ä¸ªå¯ç©ºç±»å‹ï¼ˆChar?ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªCharä¼šè¢«è‡ªåŠ¨è£…ç®±ï¼ˆboxedï¼‰ã€‚</p>
<h1 id="Booleans">Booleans</h1><p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œä¹Ÿæ˜¯è‡ªåŠ¨è£…ç®±çš„é—®é¢˜ã€‚</p>
<h1 id="Arrays">Arrays</h1><p>Kotlinä¸­çš„æ•°ç»„å†™æ³•ä¸JavaåŒºåˆ«å¾ˆå¤§ï¼Œæœ‰ä¸“é—¨çš„<code>Array</code>ç±»æ¥åˆ›å»ºå’Œæ“ä½œæ•°ç»„ã€‚</p>
<p>å¦‚æœæˆ‘æƒ³åˆ›å»ºä¸€ä¸ª[1, 2, 3]æ•°ç»„ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">val</span> a</span>:Array<span class="type">&lt;Int&gt;</span> = arrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// æ³¨æ„è¿™é‡Œçš„æ•°å­—è£…ç®±äº†</span></span><br><span class="line">a[<span class="number">0</span>] = a[<span class="number">1</span>] + a[<span class="number">2</span>] <span class="comment">// è¿™é‡Œçš„æ“ä½œä¸Javaä¸€æ ·</span></span><br></pre></td></tr></table></figure>
<p>è¿˜å¯ä»¥åƒè¿™æ ·å†™ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Creates an Array&lt;String&gt; with values ["0", "1", "4", "9", "16"]</span></span><br><span class="line"><span class="variable"><span class="keyword">val</span> asc</span> = Array(<span class="number">5</span>, &#123;i -&gt; (i * i).toString()&#125;)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæƒ³è¦ä¸€ä¸ªç©ºæ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨<code>arrayOfNulls(size: Int)</code>æ–¹æ³•ã€‚</p>
<p>å¦‚æœä¸æƒ³è£…ç®±ï¼ŒKotlinä¹Ÿæä¾›ä¸€äº›åŸå­ç±»å‹ï¼ˆprimitive typeï¼‰çš„æ•°ç»„ï¼Œå¦‚<code>IntArray</code>ï¼Œ<code>ShortArray</code>ç­‰ã€‚è¿™äº›ç±»å‹æ²¡æœ‰ç»§æ‰¿<code>Array</code>ç±»å‹ï¼Œä½†æ˜¯æ‹¥æœ‰ç›¸åŒçš„æ–¹æ³•ã€‚æ¯ä¸ªç±»å‹éƒ½æœ‰å¯¹åº”çš„å·¥å‚æ–¹æ³•ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">val</span> x</span>: IntArray = intArrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">x[<span class="number">0</span>] = x[<span class="number">1</span>] + x[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<h1 id="Strings">Strings</h1><p><code>s.[0]</code>ç›¸å½“äºJavaä¸­çš„<code>s.charAt(0)</code></p>
<p>è¿˜å¯ä»¥ä½¿ç”¨iteratorï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (c <span class="keyword">in</span> str) &#123;</span><br><span class="line">    println(c)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>KotlinåŒ…å«ä¸¤ç§ç±»å‹çš„å­—ç¬¦ä¸²ï¼šä¸Javaå­—ç¬¦ä¸²ç›¸åŒçš„escaped stringså’Œæ–°çš„raw stringsã€‚escaped stringsä¸­çš„æ¢è¡Œç¬¦æ˜¯<code>\n</code>ï¼Œè€Œraw stringså°±å‰å®³äº†ã€‚çœ‹è¿™ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val text = """</span><br><span class="line">    for (c in "foo")</span><br><span class="line">    print(c)</span><br><span class="line">"""</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ç¬¬äºŒè¡Œå’Œç¬¬ä¸‰è¡Œéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒä»¬è¢«åŒ…å«åœ¨ä¸‰ä¸ªå¼•å·ä¸­ã€‚</p>
<p>Kotlinä¸­å†ä¹Ÿä¸ç”¨å†™ç¹ççš„<code>String.format</code>äº†ï¼Œåªéœ€è¦ä¸€ä¸ª<code>$</code>ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">val</span> i</span> = <span class="number">10</span></span><br><span class="line"><span class="variable"><span class="keyword">val</span> s</span> = <span class="string">"i = $i"</span> <span class="comment">// evaluates to "i = 10"</span></span><br></pre></td></tr></table></figure>
<p>ç”šè‡³å¯ä»¥åƒè¿™æ ·å†™è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">val</span> s</span> = <span class="string">"abc"</span></span><br><span class="line"><span class="variable"><span class="keyword">val</span> str</span> = <span class="string">"$s.length is $&#123;s.length&#125;"</span> <span class="comment">// evaluates to "abc.length is 3"</span></span><br></pre></td></tr></table></figure>
<p><em>è¿™ç¯‡æ˜¯ç”¨<a href="http://typora.io/" target="_blank" rel="external">Typora</a>å†™çš„ï¼Œç¡®å®å¾ˆå¥½ç”¨ï¼Œè€Œä¸”æ˜¯å›½äººå‡ºå“ï¼</em></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>å¦‚æœä½ å­¦è¿‡Rubyï¼Œä½ ä¸€å®šçŸ¥é“â€œä¸‡ç‰©çš†å¯¹è±¡â€ã€‚Kotlinä¸­ä¹Ÿä¸€æ ·ã€‚å³ä¾¿æ•°å­—(Numbers)åœ¨Kotlinä¸­æ˜¯åŸºæœ¬ç±»å‹ï¼Œä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š<code>123.toString()</code></p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹Kotlinä¸­çš„åŸºæœ¬ç±»å‹ã€‚</p>
<h1 id="]]>
    </summary>
    
      <category term="array" scheme="http://qq157755587.github.io/tags/array/"/>
    
      <category term="boolean" scheme="http://qq157755587.github.io/tags/boolean/"/>
    
      <category term="character" scheme="http://qq157755587.github.io/tags/character/"/>
    
      <category term="number" scheme="http://qq157755587.github.io/tags/number/"/>
    
      <category term="string" scheme="http://qq157755587.github.io/tags/string/"/>
    
      <category term="Kotlin" scheme="http://qq157755587.github.io/categories/Kotlin/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Kotlinå­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰åŸºæœ¬è¯­æ³•]]></title>
    <link href="http://qq157755587.github.io/2015/07/24/learning-kotlin-1/"/>
    <id>http://qq157755587.github.io/2015/07/24/learning-kotlin-1/</id>
    <published>2015-07-24T10:37:27.000Z</published>
    <updated>2015-07-25T12:01:07.000Z</updated>
    <content type="html"><![CDATA[<p>å…ˆæä¸ªé—®é¢˜</p>
<h1 id="Androidç¨‹åºå‘˜ä¸ºä»€ä¹ˆè¦å­¦Kotlinï¼Ÿ">Androidç¨‹åºå‘˜ä¸ºä»€ä¹ˆè¦å­¦Kotlinï¼Ÿ</h1><ol>
<li>Javaä¸äº‰æ°”ã€‚åœ¨1.5æ—¶ä»£Javaæˆ–è®¸è¿˜èƒ½å’ŒC#è°ˆç¬‘é£ç”Ÿï¼Œè€Œç°åœ¨C#ä¸çŸ¥é“æ¯”Javaé«˜æ˜åˆ°å“ªé‡Œå»äº†ã€‚è™½ç„¶Java8ä¸­ä¹ŸåŠ å…¥äº†é—­åŒ…ç­‰æœ‰ç”¨çš„ç‰¹æ€§ï¼Œä½†Androidåˆä¸æ”¯æŒâ€¦â€¦</li>
<li><a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="external">RxJava</a>ã€‚æƒ³è±¡è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šç”¨æˆ·è¿ç»­ç‚¹å‡»æŸä¸ªåŒºåŸŸ10æ¬¡ä¸”æ¯æ¬¡é—´éš”ä¸è¶…è¿‡500æ¯«ç§’ï¼Œåˆ™è§¦å‘ä¸€ä¸ªå½©è›‹ã€‚<br>å®ç°è¿™ä¸ªéœ€æ±‚å¾ˆå®¹æ˜“ï¼Œä½†ä»£ç ä¼šå¾ˆæ··ä¹±ã€‚æˆ‘ä»¬å¾—è‡ªå·±æ§åˆ¶è®¡æ—¶å™¨ï¼Œä¿å­˜æ—¶é—´æˆ³ï¼Œå¯èƒ½è¿˜ä¼šæœ‰ä»¤äººè®¨åŒçš„ç©ºæ¥å£ã€‚å¦‚æœç”¨RxJavaæ¥åšï¼Œå‡ è¡Œä»£ç å°±èƒ½æå®šã€‚å¦‚æœå†é…åˆKotlinçš„å‡½æ•°å¼ç¼–ç¨‹ï¼Œç®€ç›´ä¸èƒ½æ›´çˆ½~<br>å…³äºRxJavaçš„ä½¿ç”¨ï¼Œç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šäº†ã€‚æˆ‘æœ‰ç©ºäº†å¯èƒ½ä¹Ÿä¼šå†™ä¸€äº›ã€‚</li>
<li>å¦‚æœä½ å°è¯•äº†<a href="https://developer.android.com/tools/data-binding/guide.html" target="_blank" rel="external">Android Databinding</a>ï¼Œæœ‰æ²¡æœ‰å‘ç°External Librariesé‡Œé¢å¤šäº†kotlin-runtimeå’Œkotlin-stdlibï¼Ÿ<br>Googleå†…éƒ¨æ­£æ˜¯ç”¨Kotlinå¼€å‘çš„Databindingã€‚è™½ç„¶çŸ­æœŸå†…Kotlinè¿˜ä¸å¤ªå¯èƒ½æˆä¸ºAndroidå®˜æ–¹å¼€å‘è¯­è¨€ï¼Œä½†è‡³å°‘è¿™æ˜¯ä¸ªå¥½çš„è¿¹è±¡ã€‚</li>
</ol>
<h1 id="ä¸ºä»€ä¹ˆæ˜¯Kotlinï¼Ÿ">ä¸ºä»€ä¹ˆæ˜¯Kotlinï¼Ÿ</h1><p>ç°åœ¨æ›¿ä»£Javaçš„é€‰æ‹©æœ‰å¾ˆå¤šï¼ŒScalaã€Groovyéƒ½èƒ½å†™Androidï¼Œç”šè‡³å¾®è½¯æœ€æ–°å‘å¸ƒçš„Visual Studioéƒ½èƒ½è¿›æ¥æ’ä¸€è„šï¼Œä¸ºä»€ä¹ˆè¦é€‰<a href="http://kotlinlang.org/" target="_blank" rel="external">Kotlin</a>å‘¢ï¼Ÿ<br>è¿™åˆæ˜¯å¦ä¸€ä¸ªå¾ˆå¤§çš„è¯é¢˜äº†ã€‚è¯·å‚çœ‹å¤§ç¥Jake Whartonçš„è¿™ç¯‡<a href="https://docs.google.com/document/d/1ReS3ep-hjxWA8kZi0YqDbEhCqTt29hG8P44aA9W0DM8/edit" target="_blank" rel="external">æ–‡ç« </a>ï¼ˆè¦ç¿»å¢™ï¼‰ã€‚</p>
<p>é‚£ä¹ˆè¿›å…¥æ­£é¢˜ã€‚æˆ‘çš„å­¦ä¹ æ­¥éª¤åŸºæœ¬æ˜¯æŒ‰ç…§å®˜æ–¹çš„<a href="http://kotlinlang.org/docs/reference/" target="_blank" rel="external">Reference</a>æ¥ï¼Œæ‰€ä»¥å¯èƒ½å†™ç€å†™ç€å°±æˆäº†ç¿»è¯‘å®˜æ–¹æ–‡æ¡£äº†â€¦â€¦å“ˆå“ˆå“ˆå“ˆ</p>
<h1 id="Function">Function</h1><p>æœ€å¼€å§‹å­¦Cçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šè¯´ä¸ºäº†å®ç°XXXå†™ä¸ªå‡½æ•°ï¼ˆFunctionï¼‰ï¼Œå­¦Javaå°±å˜æˆäº†å†™ä¸ªæ–¹æ³•ï¼ˆMethodï¼‰ï¼Œç°åœ¨Kotlinåˆå˜æˆå‡½æ•°äº†â€¦â€¦<br>æ‰€ä»¥æˆ‘åé¢æåˆ°Javaçš„æ—¶å€™ä¼šè¯´Methodï¼Œæåˆ°Kotlinçš„æ—¶å€™ä¼šè¯´Functionï¼Œå…¶å®éƒ½æ˜¯ä¸€ä¸ªæ„æ€~</p>
<p>å…ˆçœ‹ä¸‹Javaä¸­çš„å†™æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç„¶åæ˜¯Kotlin<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">sum</span><span class="params">(a: <span class="typename">Int, b: Int</span>)</span>: Int &#123;</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>åŒºåˆ«ï¼š</p>
<ol>
<li>ç”¨funå¼€å¤´</li>
<li>æ•°æ®ç±»å‹å†™åœ¨åé¢</li>
<li>ç»“å°¾ä¸ç”¨å†™åˆ†å·</li>
</ol>
<p>è¿™è¯­æ³•è®©æˆ‘æƒ³èµ·äº†Action Scriptï¼Œå†™æƒ¯äº†Javaå†æ¥å†™Kotlinæ€»è§‰å¾—æœ‰äº›åˆ«æ‰­â€¦â€¦</p>
<p>å¦‚æœæƒ³ç®€æ´ä¸€ç‚¹å¯ä»¥è¿™æ ·å†™åœ¨ä¸€è¡Œé‡Œï¼Œå¹¶ä¸”è¿”å›å€¼ç±»å‹å¯ä»¥æ˜¯éšå¼ï¼ˆinferredï¼‰çš„ã€‚ä¸è¿‡æˆ‘ä¸ªäººä¸å¤ªå–œæ¬¢è¿™æ ·å†™ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">sum</span><span class="params">(a: <span class="typename">Int, b: Int</span>)</span> = a + b</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯public functionå°±å¿…é¡»æ˜¾å¼çš„æ ‡æ˜è¿”å›ç±»å‹</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="title">sum</span><span class="params">(a: <span class="typename">Int, b: Int</span>)</span>: Int = a + b</span></span><br></pre></td></tr></table></figure>
<p>æ²¡æœ‰è¿”å›å€¼åˆ™ç”¨<strong>Unit</strong>å…³é”®å­—</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">printSum</span><span class="params">(a: <span class="typename">Int, b: Int</span>)</span>: Unit &#123;</span></span><br><span class="line">    print(a + b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å³ä½¿å‡½æ•°æ˜¯publicçš„ï¼ŒUnitä¹Ÿå¯ä»¥çœç•¥æ‰<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="title">printSum</span><span class="params">(a: <span class="typename">Int, b: Int</span>)</span> &#123;</span></span><br><span class="line">    print(a + b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="local_variables">local variables</h1><p>åªè¯»å˜é‡ï¼ˆread-onlyï¼‰ç”¨<strong>val</strong>å®šä¹‰<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">val</span> a</span>: <span class="typename">Int</span> = <span class="number">1</span></span><br><span class="line"><span class="variable"><span class="keyword">val</span> b</span> = <span class="number">1</span> <span class="comment">// å¦‚æœèµ‹äº†åˆå§‹å€¼å€¼ï¼Œå¯ä»¥çœç•¥æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="variable"><span class="keyword">val</span> c</span>: <span class="typename">Int</span> <span class="comment">// å¦åˆ™éœ€è¦æŒ‡å®šç±»å‹</span></span><br><span class="line">c = <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>å¯å˜å˜é‡ï¼ˆmutableï¼‰ç”¨<strong>var</strong>å®šä¹‰<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">var</span> x</span> = <span class="number">5</span></span><br><span class="line">x += <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<h1 id="string_templates">string templates</h1><p>ç”¨<strong>${}</strong>åŒ…ä½å˜é‡å°±è¡Œäº†ï¼Œè¿™æ¯”Javaä¸­çš„String.valueofæ–¹ä¾¿å¤šäº†<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">val</span> a</span> = <span class="number">1</span></span><br><span class="line">print(<span class="string">"Value of a: $&#123;a&#125;"</span>&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="conditional_expressions">conditional expressions</h1><p>çœ‹èµ·æ¥æœ‰ç‚¹åƒä¸‰å…ƒè¡¨è¾¾å¼ï¼Œä½†å¯è¯»æ€§æ›´å¼º<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">max</span><span class="params">(a: <span class="typename">Int, b: Int</span>)</span> = <span class="title">if</span> <span class="params">(a &gt; b)</span> a <span class="keyword">else</span> b</span></span><br></pre></td></tr></table></figure></p>
<h1 id="nullable_values">nullable values</h1><p>å†™javaçš„åŒå­¦ä¸€å®šå—å¤Ÿäº†NullPointerExceptionå§ã€‚Kotlinä¸Javaå¾ˆå¤§ä¸åŒçš„ä¸€ç‚¹å°±æ˜¯æ˜¾ç¤ºçš„æ ‡æ˜äº†valueæ˜¯å¦å¯èƒ½ä¸ºç©ºã€‚<br>å¦‚æœå¯èƒ½ä¸ºç©ºï¼Œåˆ™ç”¨<strong>?</strong>æ³¨æ˜<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">var</span> x</span>: <span class="typename">Int</span>?</span><br></pre></td></tr></table></figure></p>
<p>å…ˆçŸ¥é“æœ‰è¿™ä¹ˆå›äº‹å°±è¡Œäº†ï¼Œåé¢çš„ç« èŠ‚ä¼šè¯¦ç»†è¯´æ˜ã€‚</p>
<h1 id="type_checks_&amp;_automatic_casts">type checks &amp; automatic casts</h1><p>å’ŒC#ä¸€æ ·ï¼Œç”¨<strong>is</strong>æ“ä½œç¬¦æ¥åˆ¤æ–­å˜é‡çš„ç±»å‹<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getStringLength</span><span class="params">(obj: <span class="typename">Any</span>)</span>: Int? &#123;</span></span><br><span class="line">    <span class="keyword">if</span> (obj <span class="keyword">is</span> String) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj.length <span class="comment">// æ³¨æ„è¿™é‡Œobjå·²ç»è‡ªåŠ¨è½¬æˆStringç±»å‹äº†ï¼Œæ‰€ä»¥å¯ä»¥è°ƒç”¨lengthæ–¹æ³•</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span> <span class="comment">// è¿™é‡Œobjä¾ç„¶æ˜¯Anyç±»å‹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="loop">loop</h1><p>å’ŒJavaç›¸æ¯”æ˜¯æŠŠå†’å·æ”¹æˆäº†<strong>in</strong><br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="typename">Array&lt;String&gt;</span>)</span> &#123;</span></span><br><span class="line">    <span class="keyword">for</span> (arg <span class="keyword">in</span> args)</span><br><span class="line">        print(arg)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="while_loop">while loop</h1><p>å’ŒJavaåŸºæœ¬ä¸€æ ·<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="typename">Array&lt;String&gt;</span>)</span> &#123; </span></span><br><span class="line">    <span class="variable"><span class="keyword">var</span> i</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> (i <span class="type">&lt; args.size())</span><br><span class="line">        print(args[i++]) </span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure></p>
<h1 id="when_expression">when expression</h1><p><strong>when</strong>å¯ä»¥ç±»æ¯”Javaä¸­çš„<strong>switch case</strong>ï¼Œä½†æ˜¯æ›´åŠ å¼ºå¤§ï¼Œå¯ä»¥æ¥å—å„ç§æ“ä½œç¬¦<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">cases</span><span class="params">(obj: <span class="typename">Any</span>)</span> &#123; </span></span><br><span class="line">    <span class="keyword">when</span> (obj) &#123;</span><br><span class="line">        <span class="number">1</span> -&gt; print(<span class="string">"One"</span>)</span><br><span class="line">        <span class="string">"Hello"</span> -&gt; print(<span class="string">"Greeting"</span>)</span><br><span class="line">        <span class="keyword">is</span> <span class="typename">Long</span> -&gt; print(<span class="string">"Long"</span>)</span><br><span class="line">        !<span class="keyword">is</span> String -&gt; print(<span class="string">"Not a string"</span>)</span><br><span class="line">        <span class="keyword">else</span> -&gt; print(<span class="string">"Unknow"</span>)</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="ranges">ranges</h1><p><strong>in</strong>æ“ä½œç¬¦å¤ªå¥½ç”¨äº†ï¼Œæˆ‘å°±ä¸è´´å¯¹åº”çš„Javaä»£ç äº†ï¼Œå› ä¸ºæƒ³æƒ³å°±è§‰å¾—éº»çƒ¦â€¦â€¦<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (x <span class="keyword">in</span> <span class="number">1.</span>.y-<span class="number">1</span>) </span><br><span class="line">    print(<span class="string">"OK"</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> (x !<span class="keyword">in</span> <span class="number">0.</span>.array.lastIndex) </span><br><span class="line">    print(<span class="string">"Out"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (x <span class="keyword">in</span> <span class="number">1.</span>.<span class="number">5</span>) </span><br><span class="line">    print(x)</span><br></pre></td></tr></table></figure></p>
<h1 id="collections">collections</h1><p>collectionsé…åˆinä½¿ç”¨å¾ˆæ–¹ä¾¿<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (text <span class="keyword">in</span> names) <span class="comment">// è¿™é‡Œè°ƒç”¨äº†names.contains(text) </span></span><br><span class="line">    print(<span class="string">"Yes"</span>)</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœé…åˆå‡½æ•°å¼ç¼–ç¨‹å’ŒLambdasè¡¨è¾¾å¼å°±ä¸èƒ½æ›´çˆ½â€¦â€¦<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">names filter &#123; it.startsWith(<span class="string">"A"</span>) &#125; </span><br><span class="line">      sortBy &#123; it &#125; </span><br><span class="line">      map &#123; it.toUpperCase() &#125; </span><br><span class="line">      forEach &#123; print(it) &#125;</span><br></pre></td></tr></table></figure></p>
<p>æ³¨æ„è¿™é‡Œå‡½æ•°å‰é¢æ²¡æœ‰å°åœ†ç‚¹ï¼ˆ<strong>.</strong>ï¼‰ï¼Œè¿™ä¸ªå¤§æ¦‚æ˜¯ç‰¹æœ‰çš„ç®€å†™ï¼Œåé¢å†æ…¢æ…¢å­¦å§~</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>å…ˆæä¸ªé—®é¢˜</p>
<h1 id="Androidç¨‹åºå‘˜ä¸ºä»€ä¹ˆè¦å­¦Kotlinï¼Ÿ">Androidç¨‹åºå‘˜ä¸ºä»€ä¹ˆè¦å­¦Kotlinï¼Ÿ</h1><ol>
<li>Javaä¸äº‰æ°”ã€‚åœ¨1.5æ—¶ä»£Javaæˆ–è®¸è¿˜èƒ½å’ŒC#è°ˆç¬‘é£ç”Ÿï¼Œè€Œç°åœ¨C#ä¸çŸ¥é“æ¯”Javaé«˜æ˜åˆ°å“ªé‡Œå»äº†ã€‚è™½ç„¶Java8ä¸­]]>
    </summary>
    
      <category term="syntax" scheme="http://qq157755587.github.io/tags/syntax/"/>
    
      <category term="Kotlin" scheme="http://qq157755587.github.io/categories/Kotlin/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[åœ¨Androidä¸­å°†æ–‡æœ¬è½¬ä¸ºæ›²çº¿]]></title>
    <link href="http://qq157755587.github.io/2015/07/18/android-convert-text-to-curves/"/>
    <id>http://qq157755587.github.io/2015/07/18/android-convert-text-to-curves/</id>
    <published>2015-07-18T08:09:27.000Z</published>
    <updated>2015-07-20T10:24:14.000Z</updated>
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨Androidå¹³å°ä¸Šç”ŸæˆPDFæ–‡ä»¶æ—¶ï¼Œç¢°åˆ°äº†å†…åµŒå­—ä½“çš„é—®é¢˜ã€‚å¤§éƒ¨åˆ†æ‰“å°å‚çš„æœºå™¨æ˜¯ä¸æ”¯æŒPDFå†…åµŒå­—ä½“çš„ï¼Œ<br>æ‰€ä»¥è¦æƒ³å°†æ–‡å­—æŒ‰æŒ‡å®šçš„å­—ä½“å°åˆ·å‡ºæ¥ï¼Œåªèƒ½<a href="http://baike.baidu.com/subview/8597409/8551998.htm" target="_blank" rel="external">è½¬æ›²</a>ã€‚</p>
<h1 id="è½¬æ›²">è½¬æ›²</h1><p>è½¬æ›²çš„æ„æ€å°±æ˜¯æŠŠæ–‡å­—è½¬æˆæ›²çº¿çº¿æ®µï¼Œå¯ä»¥æƒ³è±¡æˆæŠŠæ–‡å­—çš„è½®å»“å‹¾å‹’å‡ºæ¥ã€‚<br>Androidä¸­çš„<a href="http://developer.android.com/reference/android/graphics/Paint.html#getTextPath(java.lang.String, int, int, float, float, android.graphics.Path" target="_blank" rel="external">Paint.getTextPath</a><br>æ–¹æ³•å¯ä»¥è·å¾—Stringçš„Pathï¼Œè€Œ<a href="http://developer.android.com/reference/android/graphics/PathMeasure.html" target="_blank" rel="external">PathMeasure</a>å¯ä»¥è·å¾—Pathä¸­çš„å…³é”®ç‚¹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Paint paint = <span class="keyword">new</span> Paint(Paint.ANTI_ALIAS_FLAG);</span><br><span class="line">paint.setTextSize(yourTextSize);</span><br><span class="line">Path fontPath = <span class="keyword">new</span> Path();</span><br><span class="line">paint.getTextPath(yourText, <span class="number">0</span>, yourText.length(), <span class="number">0f</span>, paint.getFontSpacing(), fontPath);</span><br><span class="line">PathMeasure pathMeasure = <span class="keyword">new</span> PathMeasure(fontPath, <span class="keyword">false</span>);</span><br><span class="line"><span class="keyword">float</span>[] pos = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">2</span>]; <span class="comment">// posç”¨æ¥å­˜æ”¾æ¯ä¸€ä¸ªå…³é”®ç‚¹</span></span><br><span class="line">do &#123;</span><br><span class="line">    <span class="keyword">float</span> distance = <span class="number">0f</span>;</span><br><span class="line">    <span class="keyword">while</span> (distance &lt; pathMeasure.getLength()) &#123;</span><br><span class="line">        pathMeasure.getPosTan(distance, pos, <span class="keyword">null</span>);</span><br><span class="line">        <span class="comment">// åœ¨è¿™é‡Œå°†posè®¾ç½®åˆ°ä½ è‡ªå·±çš„æ›²çº¿é‡Œ</span></span><br><span class="line">        <span class="comment">// æˆ‘ä½¿ç”¨PDFjetç”ŸæˆPDFï¼Œé‚£ä¹ˆè¿™é‡Œå°±å°†posä¿å­˜åˆ°com.pdfjet.Pointä¸­</span></span><br><span class="line">        distance += <span class="number">0.1f</span>; <span class="comment">// 0.1fæ˜¯æ¯ä¸ªå…³é”®ç‚¹çš„é—´éš”ã€‚é—´éš”è¶Šå¤§è½®å»“è¶Šç²—ç³™ï¼Œåä¹‹è¶Šç»†è…»ã€‚å¦‚æœè®¾çš„è¿‡å°ä¼šå½±å“æ€§èƒ½ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">while</span> (pathMeasure.nextContour());<span class="comment">// nextContourä¼šè·³åˆ°ä¸‹ä¸€æ®µæ›²çº¿</span></span><br></pre></td></tr></table></figure>
<h1 id="è®¡ç®—æ›²çº¿åµŒå¥—å±‚æ•°">è®¡ç®—æ›²çº¿åµŒå¥—å±‚æ•°</h1><p>å¾—åˆ°æ–‡å­—æ›²çº¿åè¿˜ä¸èƒ½ç›´æ¥å°åˆ·ï¼Œå› ä¸ºæˆ‘ä»¬åªæ˜¯å¾—åˆ°äº†æ–‡å­—çš„è½®å»“ï¼Œè¿˜å¾—å¾€è½®å»“é‡Œå¡«è‰²ã€‚<br>å½“ç„¶ä¸èƒ½æ‰€æœ‰è½®å»“éƒ½å¡«é»‘è‰²ï¼Œè¿™æ ·æ–‡å­—ä¼šå˜æˆä¸€å¨ä¸€å¨çš„é»‘è‰²â€¦â€¦<br>æˆ‘ä»¬éœ€è¦è®¡ç®—æ¯æ¡æ›²çº¿è¢«å¤šå°‘æ¡æ›²çº¿å…¨åŒ…å›´ï¼ˆæ³¨æ„æˆ‘ä»¬ç°åœ¨å¾—åˆ°çš„æ›²çº¿å…¨éƒ½æ˜¯å¤´å°¾ç›¸è¿çš„ï¼‰ã€‚<br>å¦‚æœè¢«å¶æ•°æ¡æ›²çº¿ï¼ˆåŒ…å«0æ¡ï¼‰åŒ…å›´ï¼Œåˆ™å¡«é»‘è‰²ï¼›å¦‚æœè¢«å¥‡æ•°æ¡æ›²çº¿åŒ…å›´ï¼Œåˆ™å¡«ç™½è‰²ï¼ˆåº•è‰²ï¼‰ã€‚<br>Androidæˆ–Javaæœ¬èº«ä¸æä¾›è¿™æ ·çš„æ–¹æ³•ï¼Œè¿˜å¥½å·²ç»æœ‰äººå¸®æˆ‘ä»¬ç ”ç©¶å‡ºæ–¹æ³•äº†ï¼Œè¯¦ç»†å‚çœ‹<a href="http://alienryderflex.com/polygon/ã€‚" target="_blank" rel="external">http://alienryderflex.com/polygon/ã€‚</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Polygon</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Polygon coodinates.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span>[] polyY, polyX;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Number of sides in the polygon.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> polySides;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Default constructor.</span><br><span class="line">     * <span class="doctag">@param</span> px Polygon y coods.</span><br><span class="line">     * <span class="doctag">@param</span> py Polygon x coods.</span><br><span class="line">     * <span class="doctag">@param</span> ps Polygon sides count.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Polygon</span><span class="params">( <span class="keyword">float</span>[] px, <span class="keyword">float</span>[] py, <span class="keyword">int</span> ps )</span> </span>&#123;</span><br><span class="line">        polyX = px;</span><br><span class="line">        polyY = py;</span><br><span class="line">        polySides = ps;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Checks if the Polygon contains a point.</span><br><span class="line">     * <span class="doctag">@see</span> "http://alienryderflex.com/polygon/"</span><br><span class="line">     * <span class="doctag">@param</span> x Point horizontal pos.</span><br><span class="line">     * <span class="doctag">@param</span> y Point vertical pos.</span><br><span class="line">     * <span class="doctag">@return</span> Point is in Poly flag.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">( <span class="keyword">float</span> x, <span class="keyword">float</span> y )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> oddTransitions = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>, j = polySides -<span class="number">1</span>; i &lt; polySides; j = i++ ) &#123;</span><br><span class="line">            <span class="keyword">if</span>((Float.compare(polyY[i], y) &lt; <span class="number">0</span> &amp;&amp; Float.compare(polyY[j], y) &gt;= <span class="number">0</span> ) || ( Float.compare(polyY[j], y) &lt; <span class="number">0</span> &amp;&amp; Float.compare(polyY[i], y) &gt;= <span class="number">0</span>))&#123;</span><br><span class="line">                <span class="keyword">if</span>(Float.compare(polyX[i] + ( y - polyY[i] ) / ( polyY[j] - polyY[i] ) * ( polyX[j] - polyX[i] ), x) &lt; <span class="number">0</span> ) &#123;</span><br><span class="line">                    oddTransitions = !oddTransitions;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> oddTransitions;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Polygonçš„æ„é€ æ–¹æ³•å‰ä¸¤ä¸ªå‚æ•°å¡«å¤šè¾¹å½¢ï¼ˆå¯ä»¥å°†æ›²çº¿ç†è§£ä¸ºå¤šè¾¹å½¢ï¼‰æ¨ªåæ ‡å’Œçºµåæ ‡çš„æ•°ç»„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å¡«å¤šè¾¹å½¢çš„è¾¹æ•°ï¼Œå³åæ ‡çš„ä¸ªæ•°ã€‚<br>containsæ–¹æ³•å³å¯æ£€æŸ¥æŸä¸ªç‚¹æ˜¯å¦åœ¨è¿™ä¸ªå¤šè¾¹å½¢ä¸­ã€‚<br>é‚£ä¹ˆæ€è·¯å°±å¾ˆç®€å•äº†ï¼šå¦‚æœæ›²çº¿Açš„ä»»ä¸€å…³é”®ç‚¹ä¸åœ¨æ›²çº¿Bä¸­ï¼ŒBå°±æ²¡æœ‰åŒ…å›´Aã€‚<br>ä»£ç å°±ä¸è´´äº†ã€‚</p>
<h1 id="å¡«è‰²">å¡«è‰²</h1><p>å¦‚ä¸Šæ‰€è¿°ï¼Œå¦‚æœè¢«å¶æ•°æ¡æ›²çº¿åŒ…å›´ï¼Œå¡«é»‘è‰²ï¼›è¢«å¥‡æ•°æ¡æ›²çº¿åŒ…å›´ï¼Œå¡«ç™½è‰²ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> nestingNum = surroundedNumber(pathPointsList, pathPoints);</span><br><span class="line"><span class="keyword">if</span> (nestingNum % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">    paint.setColor(Color.BLACK);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    paint.setColor(Color.WHITE);</span><br><span class="line">&#125;</span><br><span class="line">canvas.drawPath(path, paint);</span><br></pre></td></tr></table></figure>
<p>å¤§åŠŸå‘Šæˆ~</p>
<p>è¯¦ç»†ä»£ç è¯·å‚è€ƒ<a href="https://gist.github.com/qq157755587/32e927e77e259cd84631" target="_blank" rel="external">https://gist.github.com/qq157755587/32e927e77e259cd84631</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ€è¿‘åœ¨Androidå¹³å°ä¸Šç”ŸæˆPDFæ–‡ä»¶æ—¶ï¼Œç¢°åˆ°äº†å†…åµŒå­—ä½“çš„é—®é¢˜ã€‚å¤§éƒ¨åˆ†æ‰“å°å‚çš„æœºå™¨æ˜¯ä¸æ”¯æŒPDFå†…åµŒå­—ä½“çš„ï¼Œ<br>æ‰€ä»¥è¦æƒ³å°†æ–‡å­—æŒ‰æŒ‡å®šçš„å­—ä½“å°åˆ·å‡ºæ¥ï¼Œåªèƒ½<a href="http://baike.baidu.com/subview/8597409/8551998.ht]]>
    </summary>
    
      <category term="PDF" scheme="http://qq157755587.github.io/tags/PDF/"/>
    
      <category term="Paint" scheme="http://qq157755587.github.io/tags/Paint/"/>
    
      <category term="Path" scheme="http://qq157755587.github.io/tags/Path/"/>
    
      <category term="Android" scheme="http://qq157755587.github.io/categories/Android/"/>
    
  </entry>
  
</feed>